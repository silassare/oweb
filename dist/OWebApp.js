import OWebConfigs from './OWebConfigs';
import OWebDataStore from './OWebDataStore';
import OWebEvent from './OWebEvent';
import OWebForm from './OWebForm';
import OWebRouter from './OWebRouter';
import OWebUrl from './OWebUrl';
import OWebView from './OWebView';
import OWebI18n from './OWebI18n';
import { assign, id, logger } from './utils';
import OZone from './ozone';
import OWebXHR from './OWebXHR';
import defaultAppConfigs from './default/app.configs';
import defaultUserConfigs from './default/user.configs';
import defaultAppUrls from './default/app.urls';
import { OFormDOMFormAdapter, OFormObjectAdapter } from './OWebFormAdapter';
export default class OWebApp extends OWebEvent {
    options;
    static SELF = id();
    static EVT_APP_READY = id();
    static EVT_NOT_FOUND = id();
    static EVT_SHOW_HOME = id();
    static EVT_SHOW_LOGIN = id();
    static EVT_SHOW_REGISTRATION_PAGE = id();
    view;
    ls;
    router;
    configs;
    url;
    i18n;
    oz;
    _user;
    _store;
    _pager;
    constructor(options) {
        super();
        this.options = options;
        this.ls = new OWebDataStore(this);
        this.configs = new OWebConfigs(this, assign({}, defaultAppConfigs, options.appConfigs), assign({}, defaultUserConfigs, options.userConfigs));
        this.url = new OWebUrl(this, assign({}, defaultAppUrls, options.urls));
        this.view = new OWebView();
        this.i18n = new OWebI18n();
        this._user = options.user.call(this);
        this._store = options.store.call(this);
        this._pager = options.pager.call(this);
        const ctx = this, baseUrl = this.configs.get('OW_APP_LOCAL_BASE_URL'), hashMode = this.configs.get('OW_APP_ROUTER_HASH_MODE');
        this.router = new OWebRouter(baseUrl, hashMode, function notFoundHandler(target) {
            ctx.trigger(OWebApp.EVT_NOT_FOUND, [target]);
        });
        this.i18n.setDefaultLang(this.configs.get('OW_APP_DEFAULT_LANG'));
        this.oz = OZone.instantiate(this);
    }
    request(url, options = {}) {
        logger.debug('[Net] new request', url, options);
        const event = function event(type) {
            return function eventHandler(...args) {
                logger.debug('[Net] event %s', type, url, options, args);
            };
        };
        const o = new OWebXHR(url, {
            withCredentials: true,
            ...options,
        });
        o.onFinish(event('onFinished'))
            .onError(event('onError'))
            .onFail(event('onFailed'))
            .onHttpError(event('onHttpError'))
            .onHttpSuccess(event('onHttpSuccess'))
            .onGoodNews(event('onGoodNews'))
            .onBadNews(event('onBadNews'))
            .onDownloadProgress(event('onDownloadProgress'))
            .onUploadProgress(event('onUploadProgress'))
            .onResponse(event('onResponse'));
        return o;
    }
    get user() {
        return this._user;
    }
    get store() {
        return this._store;
    }
    get pager() {
        return this._pager;
    }
    getAppName() {
        return this.options.name;
    }
    isMobileApp() {
        return 'cordova' in window;
    }
    form(form, required = [], excluded = [], checkAll = false, verbose = false) {
        return new OWebForm(this, form instanceof HTMLFormElement
            ? new OFormDOMFormAdapter(form)
            : new OFormObjectAdapter(form), required, excluded, checkAll, verbose);
    }
    forceLogin() {
        this.ls.clear();
        this.showLoginPage({});
    }
    reloadApp() {
        this.showHomePage({});
    }
    destroyApp() {
        this.ls.clear();
        this.reloadApp();
    }
    closeApp() {
        if (window.navigator && window.navigator.app) {
            window.navigator.app.exitApp();
        }
        else {
            window.close();
        }
    }
    start() {
        logger.info('[OWebApp] app started!');
        this.trigger(OWebApp.EVT_APP_READY);
        return this;
    }
    showHomePage(options = {}) {
        this.trigger(OWebApp.EVT_SHOW_HOME, [options]);
    }
    showLoginPage(options = {}) {
        this.trigger(OWebApp.EVT_SHOW_LOGIN, [options]);
    }
    showRegistrationPage(options = {}) {
        this.trigger(OWebApp.EVT_SHOW_LOGIN, [options]);
    }
    onReady(handler) {
        return this.on(OWebApp.EVT_APP_READY, handler);
    }
    onShowHomePage(handler) {
        return this.on(OWebApp.EVT_SHOW_HOME, handler);
    }
    onShowLoginPage(handler) {
        return this.on(OWebApp.EVT_SHOW_LOGIN, handler);
    }
    onShowRegistrationPage(handler) {
        return this.on(OWebApp.EVT_SHOW_REGISTRATION_PAGE, handler);
    }
    onPageNotFound(handler) {
        return this.on(OWebApp.EVT_NOT_FOUND, handler);
    }
    static create(options) {
        return new OWebApp(options);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYkFwcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9PV2ViQXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sV0FBVyxNQUFNLGVBQWUsQ0FBQztBQUN4QyxPQUFPLGFBQTZCLE1BQU0saUJBQWlCLENBQUM7QUFDNUQsT0FBTyxTQUFTLE1BQU0sYUFBYSxDQUFDO0FBQ3BDLE9BQU8sUUFBNkIsTUFBTSxZQUFZLENBQUM7QUFDdkQsT0FBTyxVQUErQyxNQUFNLGNBQWMsQ0FBQztBQUMzRSxPQUFPLE9BQU8sTUFBTSxXQUFXLENBQUM7QUFDaEMsT0FBTyxRQUFRLE1BQU0sWUFBWSxDQUFDO0FBQ2xDLE9BQU8sUUFBUSxNQUFNLFlBQVksQ0FBQztBQUNsQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDN0MsT0FBTyxLQUFLLE1BQU0sU0FBUyxDQUFDO0FBSTVCLE9BQU8sT0FBTyxNQUFNLFdBQVcsQ0FBQztBQUNoQyxPQUFPLGlCQUFpQixNQUFNLHVCQUF1QixDQUFDO0FBQ3RELE9BQU8sa0JBQWtCLE1BQU0sd0JBQXdCLENBQUM7QUFDeEQsT0FBTyxjQUFjLE1BQU0sb0JBQW9CLENBQUM7QUFDaEQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGtCQUFrQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUE4RTVFLE1BQU0sQ0FBQyxPQUFPLE9BQU8sT0FNbkIsU0FBUSxTQUFTO0lBeUJxQjtJQXhCdkMsTUFBTSxDQUFVLElBQUksR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUM1QixNQUFNLENBQVUsYUFBYSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ3JDLE1BQU0sQ0FBVSxhQUFhLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDckMsTUFBTSxDQUFVLGFBQWEsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUNyQyxNQUFNLENBQVUsY0FBYyxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ3RD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QUtELG9CQUFvQixDQUFDLFVBQTZCLEVBQUU7UUFDbkQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBT0QsT0FBTyxDQUFDLE9BQXVDO1FBQzlDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ2hELENBQUM7SUFPRCxjQUFjLENBQ2IsT0FBbUU7UUFFbkUsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQU9ELGVBQWUsQ0FDZCxPQUFtRTtRQUVuRSxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLGNBQWMsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBT0Qsc0JBQXNCLENBQ3JCLE9BQW1FO1FBRW5FLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsMEJBQTBCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0QsQ0FBQztJQU9ELGNBQWMsQ0FDYixPQUE2RDtRQUU3RCxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBT0QsTUFBTSxDQUFDLE1BQU0sQ0FDWixPQUFnQjtRQUVoQixPQUFPLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzdCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgT1dlYkNvbmZpZ3MgZnJvbSAnLi9PV2ViQ29uZmlncyc7XG5pbXBvcnQgT1dlYkRhdGFTdG9yZSwgeyBPSlNPTlZhbHVlIH0gZnJvbSAnLi9PV2ViRGF0YVN0b3JlJztcbmltcG9ydCBPV2ViRXZlbnQgZnJvbSAnLi9PV2ViRXZlbnQnO1xuaW1wb3J0IE9XZWJGb3JtLCB7IE9XZWJGb3JtT3B0aW9ucyB9IGZyb20gJy4vT1dlYkZvcm0nO1xuaW1wb3J0IE9XZWJSb3V0ZXIsIHsgT1JvdXRlU3RhdGVPYmplY3QsIE9Sb3V0ZVRhcmdldCB9IGZyb20gJy4vT1dlYlJvdXRlcic7XG5pbXBvcnQgT1dlYlVybCBmcm9tICcuL09XZWJVcmwnO1xuaW1wb3J0IE9XZWJWaWV3IGZyb20gJy4vT1dlYlZpZXcnO1xuaW1wb3J0IE9XZWJJMThuIGZyb20gJy4vT1dlYkkxOG4nO1xuaW1wb3J0IHsgYXNzaWduLCBpZCwgbG9nZ2VyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgT1pvbmUgZnJvbSAnLi9vem9uZSc7XG5pbXBvcnQgT1dlYlBhZ2VyLCB7IE9QYWdlLCBPUGFnZVJvdXRlIH0gZnJvbSAnLi9PV2ViUGFnZXInO1xuaW1wb3J0IE9XZWJVc2VyIGZyb20gJy4vT1dlYlVzZXInO1xuaW1wb3J0IHsgT05ldFJlcXVlc3RPcHRpb25zIH0gZnJvbSAnLi9PV2ViTmV0JztcbmltcG9ydCBPV2ViWEhSIGZyb20gJy4vT1dlYlhIUic7XG5pbXBvcnQgZGVmYXVsdEFwcENvbmZpZ3MgZnJvbSAnLi9kZWZhdWx0L2FwcC5jb25maWdzJztcbmltcG9ydCBkZWZhdWx0VXNlckNvbmZpZ3MgZnJvbSAnLi9kZWZhdWx0L3VzZXIuY29uZmlncyc7XG5pbXBvcnQgZGVmYXVsdEFwcFVybHMgZnJvbSAnLi9kZWZhdWx0L2FwcC51cmxzJztcbmltcG9ydCB7IE9Gb3JtRE9NRm9ybUFkYXB0ZXIsIE9Gb3JtT2JqZWN0QWRhcHRlciB9IGZyb20gJy4vT1dlYkZvcm1BZGFwdGVyJztcblxuZXhwb3J0IGludGVyZmFjZSBPVXJsTGlzdCB7XG5cdFtrZXk6IHN0cmluZ106IHN0cmluZztcblxuXHRPWl9TRVJWRVJfR0VUX0ZJTEVfVVJJOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9UTkVUX1NFUlZJQ0U6IHN0cmluZztcblx0T1pfU0VSVkVSX0xPR0lOX1NFUlZJQ0U6IHN0cmluZztcblx0T1pfU0VSVkVSX0xPR09VVF9TRVJWSUNFOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9TSUdOVVBfU0VSVklDRTogc3RyaW5nO1xuXHRPWl9TRVJWRVJfQUNDT1VOVF9SRUNPVkVSWV9TRVJWSUNFOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9QQVNTV09SRF9TRVJWSUNFOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9DQVBUQ0hBX1NFUlZJQ0U6IHN0cmluZztcblx0T1pfU0VSVkVSX1VQTE9BRF9TRVJWSUNFOiBzdHJpbmc7XG5cblx0T1dfQVBQX1BBVEhfU0lHTl9VUDogc3RyaW5nO1xuXHRPV19BUFBfUEFUSF9MT0dPVVQ6IHN0cmluZztcblx0T1dfQVBQX1BBVEhfTE9HSU46IHN0cmluZztcblx0T1dfQVBQX1BBVEhfSE9NRTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9BcHBDb25maWdzIHtcblx0W2tleTogc3RyaW5nXTogT0pTT05WYWx1ZTtcblxuXHRPV19BUFBfTkFNRTogc3RyaW5nO1xuXHRPV19BUFBfVkVSU0lPTjogc3RyaW5nO1xuXHRPV19BUFBfTE9DQUxfQkFTRV9VUkw6IHN0cmluZztcblx0T1dfQVBQX1JPVVRFUl9IQVNIX01PREU6IGJvb2xlYW47XG5cdE9XX0FQUF9BTExPV0VEX0NPVU5UUklFUzogc3RyaW5nW107XG5cblx0T1pfQVBJX0tFWTogc3RyaW5nO1xuXHRPWl9BUElfS0VZX0hFQURFUl9OQU1FOiBzdHJpbmc7XG5cdE9aX0FQSV9BTExPV19SRUFMX01FVEhPRF9IRUFERVI6IGJvb2xlYW47XG5cdE9aX0FQSV9SRUFMX01FVEhPRF9IRUFERVJfTkFNRTogc3RyaW5nO1xuXHRPWl9BUElfQkFTRV9VUkw6IHN0cmluZztcblxuXHRPWl9DT0RFX1JFRzogc3RyaW5nO1xuXHRPWl9VU0VSX05BTUVfTUlOX0xFTkdUSDogbnVtYmVyO1xuXHRPWl9VU0VSX05BTUVfTUFYX0xFTkdUSDogbnVtYmVyO1xuXHRPWl9QQVNTX01JTl9MRU5HVEg6IG51bWJlcjtcblx0T1pfUEFTU19NQVhfTEVOR1RIOiBudW1iZXI7XG5cdE9aX1VTRVJfTUlOX0FHRTogbnVtYmVyO1xuXHRPWl9VU0VSX01BWF9BR0U6IG51bWJlcjtcblx0T1pfUFBJQ19NSU5fU0laRTogbnVtYmVyO1xuXHRPWl9VU0VSX0FMTE9XRURfR0VOREVSUzogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT1VzZXJDb25maWdzIHtcblx0W2tleTogc3RyaW5nXTogT0pTT05WYWx1ZTtcblxuXHRPV19BUFBfREVGQVVMVF9MQU5HOiBzdHJpbmc7XG5cdE9XX0FQUF9DT1VOVFJZOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT1N0b3JlIHtcblx0W2tleTogc3RyaW5nXTogYW55O1xufVxuXG5leHBvcnQgdHlwZSBPVXNlciA9IHtcblx0W2tleTogc3RyaW5nXTogYW55O1xufTtcbmV4cG9ydCBpbnRlcmZhY2UgT0FwcE9wdGlvbnM8XG5cdFN0b3JlIGV4dGVuZHMgT1N0b3JlID0gT1N0b3JlLFxuXHRQYWdlIGV4dGVuZHMgT1BhZ2U8Um91dGU+ID0gT1BhZ2U8YW55Pixcblx0VXNlciBleHRlbmRzIE9Vc2VyID0gT1VzZXIsXG5cdFJvdXRlIGV4dGVuZHMgT1BhZ2VSb3V0ZSA9IE9QYWdlUm91dGUsXG5cdENvbnRleHQgPSBPV2ViQXBwPFN0b3JlLCBQYWdlLCBVc2VyPlxuPiB7XG5cdG5hbWU6IHN0cmluZztcblx0YXBwQ29uZmlnczogUGFydGlhbDxPQXBwQ29uZmlncz47XG5cdHVzZXJDb25maWdzOiBQYXJ0aWFsPE9Vc2VyQ29uZmlncz47XG5cdHVybHM6IFBhcnRpYWw8T1VybExpc3Q+O1xuXG5cdHVzZXI6ICh0aGlzOiBDb250ZXh0KSA9PiBPV2ViVXNlcjxVc2VyPjtcblx0c3RvcmU6ICh0aGlzOiBDb250ZXh0KSA9PiBTdG9yZTtcblx0cGFnZXI6ICh0aGlzOiBDb250ZXh0KSA9PiBPV2ViUGFnZXI8UGFnZT47XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9XZWJBcHA8XG5cdFN0b3JlIGV4dGVuZHMgT1N0b3JlID0gT1N0b3JlLFxuXHRQYWdlIGV4dGVuZHMgT1BhZ2U8Um91dGU+ID0gT1BhZ2U8YW55Pixcblx0VXNlciBleHRlbmRzIE9Vc2VyID0gT1VzZXIsXG5cdFJvdXRlIGV4dGVuZHMgT1BhZ2VSb3V0ZSA9IE9QYWdlUm91dGUsXG5cdE9wdGlvbnMgZXh0ZW5kcyBPQXBwT3B0aW9uczxTdG9yZSwgUGFnZSwgVXNlcj4gPSBhbnlcbj4gZXh0ZW5kcyBPV2ViRXZlbnQge1xuXHRzdGF0aWMgcmVhZG9ubHkgU0VMRiA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfQVBQX1JFQURZID0gaWQoKTtcblx0c3RhdGljIHJlYWRvbmx5IEVWVF9OT1RfRk9VTkQgPSBpZCgpO1xuXHRzdGF0aWMgcmVhZG9ubHkgRVZUX1NIT1dfSE9NRSA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfU0hPV19MT0dJTiA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfU0hPV19SRUdJU1RSQVRJT05fUEFHRSA9IGlkKCk7XG5cblx0cmVhZG9ubHkgdmlldzogT1dlYlZpZXc7XG5cdHJlYWRvbmx5IGxzOiBPV2ViRGF0YVN0b3JlO1xuXHRyZWFkb25seSByb3V0ZXI6IE9XZWJSb3V0ZXI7XG5cdHJlYWRvbmx5IGNvbmZpZ3M6IE9XZWJDb25maWdzPE9BcHBDb25maWdzLCBPVXNlckNvbmZpZ3M+O1xuXHRyZWFkb25seSB1cmw6IE9XZWJVcmw7XG5cdHJlYWRvbmx5IGkxOG46IE9XZWJJMThuO1xuXHRyZWFkb25seSBvejogT1pvbmU7XG5cblx0cHJpdmF0ZSByZWFkb25seSBfdXNlcjogT1dlYlVzZXI8VXNlcj47XG5cdHByaXZhdGUgcmVhZG9ubHkgX3N0b3JlOiBTdG9yZTtcblx0cHJpdmF0ZSByZWFkb25seSBfcGFnZXI6IE9XZWJQYWdlcjxQYWdlPjtcblxuXHQvKipcblx0ICogT1dlYkFwcCBjb25zdHJ1Y3Rvci5cblx0ICpcblx0ICogQHBhcmFtIG9wdGlvbnNcblx0ICovXG5cdHByb3RlY3RlZCBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IG9wdGlvbnM6IE9wdGlvbnMpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5scyA9IG5ldyBPV2ViRGF0YVN0b3JlKHRoaXMpO1xuXHRcdHRoaXMuY29uZmlncyA9IG5ldyBPV2ViQ29uZmlncyhcblx0XHRcdHRoaXMsXG5cdFx0XHRhc3NpZ24oe30sIGRlZmF1bHRBcHBDb25maWdzLCBvcHRpb25zLmFwcENvbmZpZ3MpLFxuXHRcdFx0YXNzaWduKHt9LCBkZWZhdWx0VXNlckNvbmZpZ3MsIG9wdGlvbnMudXNlckNvbmZpZ3MpXG5cdFx0KTtcblx0XHR0aGlzLnVybCA9IG5ldyBPV2ViVXJsKHRoaXMsIGFzc2lnbih7fSwgZGVmYXVsdEFwcFVybHMsIG9wdGlvbnMudXJscykpO1xuXHRcdHRoaXMudmlldyA9IG5ldyBPV2ViVmlldygpO1xuXHRcdHRoaXMuaTE4biA9IG5ldyBPV2ViSTE4bigpO1xuXHRcdHRoaXMuX3VzZXIgPSBvcHRpb25zLnVzZXIuY2FsbCh0aGlzKTtcblx0XHR0aGlzLl9zdG9yZSA9IG9wdGlvbnMuc3RvcmUuY2FsbCh0aGlzKTtcblx0XHR0aGlzLl9wYWdlciA9IG9wdGlvbnMucGFnZXIuY2FsbCh0aGlzKTtcblxuXHRcdGNvbnN0IGN0eCA9IHRoaXMsXG5cdFx0XHRiYXNlVXJsID0gdGhpcy5jb25maWdzLmdldCgnT1dfQVBQX0xPQ0FMX0JBU0VfVVJMJyksXG5cdFx0XHRoYXNoTW9kZSA9IHRoaXMuY29uZmlncy5nZXQoJ09XX0FQUF9ST1VURVJfSEFTSF9NT0RFJyk7XG5cblx0XHR0aGlzLnJvdXRlciA9IG5ldyBPV2ViUm91dGVyKGJhc2VVcmwsIGhhc2hNb2RlLCBmdW5jdGlvbiBub3RGb3VuZEhhbmRsZXIoXG5cdFx0XHR0YXJnZXQ6IE9Sb3V0ZVRhcmdldFxuXHRcdCkge1xuXHRcdFx0Y3R4LnRyaWdnZXIoT1dlYkFwcC5FVlRfTk9UX0ZPVU5ELCBbdGFyZ2V0XSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmkxOG4uc2V0RGVmYXVsdExhbmcodGhpcy5jb25maWdzLmdldCgnT1dfQVBQX0RFRkFVTFRfTEFORycpKTtcblxuXHRcdHRoaXMub3ogPSBPWm9uZS5pbnN0YW50aWF0ZSh0aGlzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBCdWlsZCBhbiBIVFRQIHJlcXVlc3QuXG5cdCAqXG5cdCAqIEBwYXJhbSB1cmxcblx0ICogQHBhcmFtIG9wdGlvbnNcblx0ICovXG5cdHJlcXVlc3Q8UmVzcG9uc2U+KFxuXHRcdHVybDogc3RyaW5nLFxuXHRcdG9wdGlvbnM6IFBhcnRpYWw8T05ldFJlcXVlc3RPcHRpb25zPFJlc3BvbnNlPj4gPSB7fVxuXHQpOiBPV2ViWEhSPFJlc3BvbnNlPiB7XG5cdFx0bG9nZ2VyLmRlYnVnKCdbTmV0XSBuZXcgcmVxdWVzdCcsIHVybCwgb3B0aW9ucyk7XG5cblx0XHRjb25zdCBldmVudCA9IGZ1bmN0aW9uIGV2ZW50KHR5cGU6IHN0cmluZykge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uIGV2ZW50SGFuZGxlciguLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuXHRcdFx0XHRsb2dnZXIuZGVidWcoJ1tOZXRdIGV2ZW50ICVzJywgdHlwZSwgdXJsLCBvcHRpb25zLCBhcmdzKTtcblx0XHRcdH07XG5cdFx0fTtcblxuXHRcdGNvbnN0IG8gPSBuZXcgT1dlYlhIUjxSZXNwb25zZT4odXJsLCB7XG5cdFx0XHR3aXRoQ3JlZGVudGlhbHM6IHRydWUsXG5cdFx0XHQuLi5vcHRpb25zLFxuXHRcdH0pO1xuXG5cdFx0by5vbkZpbmlzaChldmVudCgnb25GaW5pc2hlZCcpKVxuXHRcdFx0Lm9uRXJyb3IoZXZlbnQoJ29uRXJyb3InKSlcblx0XHRcdC5vbkZhaWwoZXZlbnQoJ29uRmFpbGVkJykpXG5cdFx0XHQub25IdHRwRXJyb3IoZXZlbnQoJ29uSHR0cEVycm9yJykpXG5cdFx0XHQub25IdHRwU3VjY2VzcyhldmVudCgnb25IdHRwU3VjY2VzcycpKVxuXHRcdFx0Lm9uR29vZE5ld3MoZXZlbnQoJ29uR29vZE5ld3MnKSlcblx0XHRcdC5vbkJhZE5ld3MoZXZlbnQoJ29uQmFkTmV3cycpKVxuXHRcdFx0Lm9uRG93bmxvYWRQcm9ncmVzcyhldmVudCgnb25Eb3dubG9hZFByb2dyZXNzJykpXG5cdFx0XHQub25VcGxvYWRQcm9ncmVzcyhldmVudCgnb25VcGxvYWRQcm9ncmVzcycpKVxuXHRcdFx0Lm9uUmVzcG9uc2UoZXZlbnQoJ29uUmVzcG9uc2UnKSk7XG5cblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdC8qKlxuXHQgKiBVc2VyIGdldHRlci5cblx0ICovXG5cdGdldCB1c2VyKCk6IFJldHVyblR5cGU8T3B0aW9uc1sndXNlciddPiB7XG5cdFx0cmV0dXJuIHRoaXMuX3VzZXIgYXMgUmV0dXJuVHlwZTxPcHRpb25zWyd1c2VyJ10+O1xuXHR9XG5cblx0LyoqXG5cdCAqIFN0b3JlIGdldHRlci5cblx0ICovXG5cdGdldCBzdG9yZSgpOiBSZXR1cm5UeXBlPE9wdGlvbnNbJ3N0b3JlJ10+IHtcblx0XHRyZXR1cm4gdGhpcy5fc3RvcmUgYXMgUmV0dXJuVHlwZTxPcHRpb25zWydzdG9yZSddPjtcblx0fVxuXG5cdC8qKlxuXHQgKiBQYWdlciBpbnN0YW5jZSBnZXR0ZXIuXG5cdCAqL1xuXHRnZXQgcGFnZXIoKTogUmV0dXJuVHlwZTxPcHRpb25zWydwYWdlciddPiB7XG5cdFx0cmV0dXJuIHRoaXMuX3BhZ2VyIGFzIFJldHVyblR5cGU8T3B0aW9uc1sncGFnZXInXT47XG5cdH1cblxuXHQvKipcblx0ICogQXBwIG5hbWUgZ2V0dGVyLlxuXHQgKi9cblx0Z2V0QXBwTmFtZSgpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLm9wdGlvbnMubmFtZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVja3MgaWYgd2UgYXJlIHJ1bm5pbmcgaW4gbW9iaWxlIGFwcC5cblx0ICovXG5cdGlzTW9iaWxlQXBwKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiAnY29yZG92YScgaW4gd2luZG93O1xuXHR9XG5cblx0LyoqXG5cdCAqIFJldHVybnMgbmV3IG93ZWIgZm9ybSBpbnN0YW5jZS5cblx0ICpcblx0ICogQHBhcmFtIGZvcm0gVGhlIGh0bWwgZm9ybSBlbGVtZW50LlxuXHQgKiBAcGFyYW0gcmVxdWlyZWQgVGhlIHJlcXVpcmVkIGZpZWxkcyBuYW1lcyBsaXN0LlxuXHQgKiBAcGFyYW0gZXhjbHVkZWQgVGhlIGZpZWxkcyBuYW1lcyB0byBleGNsdWRlLlxuXHQgKiBAcGFyYW0gY2hlY2tBbGwgRm9yY2UgdGhlIHZhbGlkYXRvciB0byBjaGVjayBhbGwgZmllbGRzLlxuXHQgKiBAcGFyYW0gdmVyYm9zZSBMb2cgd2FybmluZy5cblx0ICovXG5cdGZvcm0oXG5cdFx0Zm9ybTogT1dlYkZvcm1PcHRpb25zIHwgSFRNTEZvcm1FbGVtZW50LFxuXHRcdHJlcXVpcmVkOiBzdHJpbmdbXSA9IFtdLFxuXHRcdGV4Y2x1ZGVkOiBzdHJpbmdbXSA9IFtdLFxuXHRcdGNoZWNrQWxsID0gZmFsc2UsXG5cdFx0dmVyYm9zZSA9IGZhbHNlXG5cdCk6IE9XZWJGb3JtIHtcblx0XHRyZXR1cm4gbmV3IE9XZWJGb3JtKFxuXHRcdFx0dGhpcyxcblx0XHRcdGZvcm0gaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnRcblx0XHRcdFx0PyBuZXcgT0Zvcm1ET01Gb3JtQWRhcHRlcihmb3JtKVxuXHRcdFx0XHQ6IG5ldyBPRm9ybU9iamVjdEFkYXB0ZXIoZm9ybSksXG5cdFx0XHRyZXF1aXJlZCxcblx0XHRcdGV4Y2x1ZGVkLFxuXHRcdFx0Y2hlY2tBbGwsXG5cdFx0XHR2ZXJib3NlXG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGb3JjZSBsb2dpbi5cblx0ICpcblx0ICogPiBUaGlzIHdpbGwgY2xlYXIgYWxsIHNhdmVkIGRhdGEgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG5cdCAqL1xuXHRmb3JjZUxvZ2luKCk6IHZvaWQge1xuXHRcdHRoaXMubHMuY2xlYXIoKTtcblx0XHR0aGlzLnNob3dMb2dpblBhZ2Uoe30pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlbG9hZCB0aGUgYXBwLlxuXHQgKi9cblx0cmVsb2FkQXBwKCk6IHZvaWQge1xuXHRcdC8vIFRPRE86IGluc3RlYWQgb2YgcmVsb2FkaW5nIHRoZSBjdXJyZW50IGxvY2F0aW9uLCBmaW5kIGEgd2F5IHRvIGJyb3dzZSB0byB3ZWIgYXBwIGVudHJ5IHBvaW50XG5cdFx0Ly8gZm9yIGFuZHJvaWQgJiBpb3MgcmVzdGFydCB0aGUgYXBwXG5cdFx0Ly8gd2luZG93LmxvY2F0aW9uLnJlbG9hZCh0cnVlKTtcblx0XHR0aGlzLnNob3dIb21lUGFnZSh7fSk7XG5cdH1cblxuXHQvKipcblx0ICogRGVzdHJveSB0aGUgYXBwLlxuXHQgKlxuXHQgKiA+IFRoaXMgd2lsbCBjbGVhciBhbGwgc2F2ZWQgZGF0YSBpbiB0aGUgbG9jYWwgc3RvcmFnZS5cblx0ICovXG5cdGRlc3Ryb3lBcHAoKTogdm9pZCB7XG5cdFx0Ly8gZXJhc2UgZGF0YVxuXHRcdHRoaXMubHMuY2xlYXIoKTtcblx0XHR0aGlzLnJlbG9hZEFwcCgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsb3NlIGFwcC5cblx0ICovXG5cdGNsb3NlQXBwKCk6IHZvaWQge1xuXHRcdC8vIGNvcmRvdmFcblx0XHRpZiAod2luZG93Lm5hdmlnYXRvciAmJiAod2luZG93Lm5hdmlnYXRvciBhcyBhbnkpLmFwcCkge1xuXHRcdFx0KHdpbmRvdy5uYXZpZ2F0b3IgYXMgYW55KS5hcHAuZXhpdEFwcCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR3aW5kb3cuY2xvc2UoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVG8gc3RhcnQgdGhlIHdlYiBhcHAuXG5cdCAqL1xuXHRzdGFydCgpOiB0aGlzIHtcblx0XHRsb2dnZXIuaW5mbygnW09XZWJBcHBdIGFwcCBzdGFydGVkIScpO1xuXHRcdHRoaXMudHJpZ2dlcihPV2ViQXBwLkVWVF9BUFBfUkVBRFkpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0LyoqXG5cdCAqIENhbGxlZCB3aGVuIGFwcCBzaG91bGQgc2hvdyB0aGUgaG9tZSBwYWdlLlxuXHQgKi9cblx0c2hvd0hvbWVQYWdlKG9wdGlvbnM6IE9Sb3V0ZVN0YXRlT2JqZWN0ID0ge30pOiB2b2lkIHtcblx0XHR0aGlzLnRyaWdnZXIoT1dlYkFwcC5FVlRfU0hPV19IT01FLCBbb3B0aW9uc10pO1xuXHR9XG5cblx0LyoqXG5cdCAqIENhbGxlZCB3aGVuIGFwcCBzaG91bGQgc2hvdyB0aGUgbG9naW4gcGFnZS5cblx0ICovXG5cdHNob3dMb2dpblBhZ2Uob3B0aW9uczogT1JvdXRlU3RhdGVPYmplY3QgPSB7fSk6IHZvaWQge1xuXHRcdHRoaXMudHJpZ2dlcihPV2ViQXBwLkVWVF9TSE9XX0xPR0lOLCBbb3B0aW9uc10pO1xuXHR9XG5cblx0LyoqXG5cdCAqIENhbGxlZCB3aGVuIGFwcCBzaG91bGQgc2hvdyB0aGUgcmVnaXN0cmF0aW9uIHBhZ2UuXG5cdCAqL1xuXHRzaG93UmVnaXN0cmF0aW9uUGFnZShvcHRpb25zOiBPUm91dGVTdGF0ZU9iamVjdCA9IHt9KTogdm9pZCB7XG5cdFx0dGhpcy50cmlnZ2VyKE9XZWJBcHAuRVZUX1NIT1dfTE9HSU4sIFtvcHRpb25zXSk7XG5cdH1cblxuXHQvKipcblx0ICogUmVnaXN0ZXIgaGFuZGxlciBmb3IgT1dlYkFwcC5FVlRfQVBQX1JFQURZIGV2ZW50XG5cdCAqXG5cdCAqIEBwYXJhbSBoYW5kbGVyXG5cdCAqL1xuXHRvblJlYWR5KGhhbmRsZXI6ICh0aGlzOiB0aGlzKSA9PiB2b2lkIHwgYm9vbGVhbik6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJBcHAuRVZUX0FQUF9SRUFEWSwgaGFuZGxlcik7XG5cdH1cblxuXHQvKipcblx0ICogUmVnaXN0ZXIgaGFuZGxlciBmb3IgT1dlYkFwcC5FVlRfU0hPV19IT01FIGV2ZW50XG5cdCAqXG5cdCAqIEBwYXJhbSBoYW5kbGVyXG5cdCAqL1xuXHRvblNob3dIb21lUGFnZShcblx0XHRoYW5kbGVyOiAodGhpczogdGhpcywgb3B0aW9uczogT1JvdXRlU3RhdGVPYmplY3QpID0+IHZvaWQgfCBib29sZWFuXG5cdCk6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJBcHAuRVZUX1NIT1dfSE9NRSwgaGFuZGxlcik7XG5cdH1cblxuXHQvKipcblx0ICogUmVnaXN0ZXIgaGFuZGxlciBmb3IgT1dlYkFwcC5FVlRfU0hPV19MT0dJTiBldmVudFxuXHQgKlxuXHQgKiBAcGFyYW0gaGFuZGxlclxuXHQgKi9cblx0b25TaG93TG9naW5QYWdlKFxuXHRcdGhhbmRsZXI6ICh0aGlzOiB0aGlzLCBvcHRpb25zOiBPUm91dGVTdGF0ZU9iamVjdCkgPT4gdm9pZCB8IGJvb2xlYW5cblx0KTogdGhpcyB7XG5cdFx0cmV0dXJuIHRoaXMub24oT1dlYkFwcC5FVlRfU0hPV19MT0dJTiwgaGFuZGxlcik7XG5cdH1cblxuXHQvKipcblx0ICogUmVnaXN0ZXIgaGFuZGxlciBmb3IgT1dlYkFwcC5FVlRfU0hPV19SRUdJU1RSQVRJT05fUEFHRSBldmVudFxuXHQgKlxuXHQgKiBAcGFyYW0gaGFuZGxlclxuXHQgKi9cblx0b25TaG93UmVnaXN0cmF0aW9uUGFnZShcblx0XHRoYW5kbGVyOiAodGhpczogdGhpcywgb3B0aW9uczogT1JvdXRlU3RhdGVPYmplY3QpID0+IHZvaWQgfCBib29sZWFuXG5cdCk6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJBcHAuRVZUX1NIT1dfUkVHSVNUUkFUSU9OX1BBR0UsIGhhbmRsZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGhhbmRsZXIgZm9yIE9XZWJBcHAuRVZUX05PVF9GT1VORCBldmVudFxuXHQgKlxuXHQgKiBAcGFyYW0gaGFuZGxlclxuXHQgKi9cblx0b25QYWdlTm90Rm91bmQoXG5cdFx0aGFuZGxlcjogKHRoaXM6IHRoaXMsIHRhcmdldDogT1JvdXRlVGFyZ2V0KSA9PiB2b2lkIHwgYm9vbGVhblxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViQXBwLkVWVF9OT1RfRk9VTkQsIGhhbmRsZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgbmV3IGFwcCBpbnN0YW5jZS5cblx0ICpcblx0ICogQHBhcmFtIG9wdGlvbnNcblx0ICovXG5cdHN0YXRpYyBjcmVhdGU8T3B0aW9ucyBleHRlbmRzIE9BcHBPcHRpb25zPE9TdG9yZSwgT1BhZ2UsIE9Vc2VyPiA9IGFueT4oXG5cdFx0b3B0aW9uczogT3B0aW9uc1xuXHQpOiBPV2ViQXBwPGFueSwgYW55LCBhbnksIGFueSwgT3B0aW9ucz4ge1xuXHRcdHJldHVybiBuZXcgT1dlYkFwcChvcHRpb25zKTtcblx0fVxufVxuIl19