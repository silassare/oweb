import OWebConfigs from './OWebConfigs';
import OWebDataStore from './OWebDataStore';
import OWebEvent from './OWebEvent';
import OWebForm from './OWebForm';
import OWebRouter from './OWebRouter';
import OWebUrl from './OWebUrl';
import OWebView from './OWebView';
import OWebI18n from './OWebI18n';
import { assign, id, logger } from './utils';
import OZone from './ozone';
import OWebXHR from './OWebXHR';
import defaultAppConfigs from './default/app.configs';
import defaultUserConfigs from './default/user.configs';
import defaultAppUrls from './default/app.urls';
import { OFormDOMFormAdapter, OFormObjectAdapter } from './OWebFormAdapter';
export default class OWebApp extends OWebEvent {
    options;
    static SELF = id();
    static EVT_APP_READY = id();
    static EVT_NOT_FOUND = id();
    static EVT_SHOW_HOME = id();
    static EVT_SHOW_LOGIN = id();
    static EVT_SHOW_REGISTRATION_PAGE = id();
    view;
    ls;
    router;
    user;
    configs;
    url;
    i18n;
    oz;
    _store;
    _pager;
    constructor(options) {
        super();
        this.options = options;
        this.ls = new OWebDataStore(this);
        this.configs = new OWebConfigs(this, assign({}, defaultAppConfigs, options.appConfigs), assign({}, defaultUserConfigs, options.userConfigs));
        this.url = new OWebUrl(this, assign({}, defaultAppUrls, options.urls));
        this.view = new OWebView();
        this.i18n = new OWebI18n();
        this.user = options.user.call(this);
        this._store = options.store.call(this);
        this._pager = options.pager.call(this);
        const ctx = this, baseUrl = this.configs.get('OW_APP_LOCAL_BASE_URL'), hashMode = this.configs.get('OW_APP_ROUTER_HASH_MODE');
        this.router = new OWebRouter(baseUrl, hashMode, function notFoundHandler(target) {
            ctx.trigger(OWebApp.EVT_NOT_FOUND, [target]);
        });
        this.i18n.setDefaultLang(this.configs.get('OW_APP_DEFAULT_LANG'));
        this.oz = OZone.instantiate(this);
    }
    request(url, options = {}) {
        logger.debug('[Net] new request', url, options);
        const event = function event(type) {
            return function eventHandler(...args) {
                logger.debug('[Net] event %s', type, url, options, args);
            };
        };
        const o = new OWebXHR(url, {
            withCredentials: true,
            ...options,
        });
        o.onFinish(event('onFinished'))
            .onError(event('onError'))
            .onFail(event('onFailed'))
            .onHttpError(event('onHttpError'))
            .onHttpSuccess(event('onHttpSuccess'))
            .onGoodNews(event('onGoodNews'))
            .onBadNews(event('onBadNews'))
            .onDownloadProgress(event('onDownloadProgress'))
            .onUploadProgress(event('onUploadProgress'))
            .onResponse(event('onResponse'));
        return o;
    }
    get store() {
        return this._store;
    }
    get pager() {
        return this._pager;
    }
    getAppName() {
        return this.options.name;
    }
    isMobileApp() {
        return 'cordova' in window;
    }
    form(form, required = [], excluded = [], checkAll = false, verbose = false) {
        return new OWebForm(this, form instanceof HTMLFormElement
            ? new OFormDOMFormAdapter(form)
            : new OFormObjectAdapter(form), required, excluded, checkAll, verbose);
    }
    forceLogin() {
        this.ls.clear();
        this.showLoginPage({});
    }
    reloadApp() {
        this.showHomePage({});
    }
    destroyApp() {
        this.ls.clear();
        this.reloadApp();
    }
    closeApp() {
        if (window.navigator && window.navigator.app) {
            window.navigator.app.exitApp();
        }
        else {
            window.close();
        }
    }
    start() {
        logger.info('[OWebApp] app started!');
        this.trigger(OWebApp.EVT_APP_READY);
        return this;
    }
    showHomePage(options = {}) {
        this.trigger(OWebApp.EVT_SHOW_HOME, [options]);
    }
    showLoginPage(options = {}) {
        this.trigger(OWebApp.EVT_SHOW_LOGIN, [options]);
    }
    showRegistrationPage(options = {}) {
        this.trigger(OWebApp.EVT_SHOW_LOGIN, [options]);
    }
    onReady(handler) {
        return this.on(OWebApp.EVT_APP_READY, handler);
    }
    onShowHomePage(handler) {
        return this.on(OWebApp.EVT_SHOW_HOME, handler);
    }
    onShowLoginPage(handler) {
        return this.on(OWebApp.EVT_SHOW_LOGIN, handler);
    }
    onShowRegistrationPage(handler) {
        return this.on(OWebApp.EVT_SHOW_REGISTRATION_PAGE, handler);
    }
    onPageNotFound(handler) {
        return this.on(OWebApp.EVT_NOT_FOUND, handler);
    }
    static create(options) {
        return new OWebApp(options);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYkFwcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9PV2ViQXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sV0FBVyxNQUFNLGVBQWUsQ0FBQztBQUN4QyxPQUFPLGFBQTZCLE1BQU0saUJBQWlCLENBQUM7QUFDNUQsT0FBTyxTQUFTLE1BQU0sYUFBYSxDQUFDO0FBQ3BDLE9BQU8sUUFBNkIsTUFBTSxZQUFZLENBQUM7QUFDdkQsT0FBTyxVQUErQyxNQUFNLGNBQWMsQ0FBQztBQUMzRSxPQUFPLE9BQU8sTUFBTSxXQUFXLENBQUM7QUFDaEMsT0FBTyxRQUFRLE1BQU0sWUFBWSxDQUFDO0FBQ2xDLE9BQU8sUUFBUSxNQUFNLFlBQVksQ0FBQztBQUNsQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDN0MsT0FBTyxLQUFLLE1BQU0sU0FBUyxDQUFDO0FBSTVCLE9BQU8sT0FBTyxNQUFNLFdBQVcsQ0FBQztBQUNoQyxPQUFPLGlCQUFpQixNQUFNLHVCQUF1QixDQUFDO0FBQ3RELE9BQU8sa0JBQWtCLE1BQU0sd0JBQXdCLENBQUM7QUFDeEQsT0FBTyxjQUFjLE1BQU0sb0JBQW9CLENBQUM7QUFDaEQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGtCQUFrQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFrRjVFLE1BQU0sQ0FBQyxPQUFPLE9BQU8sT0FLbkIsU0FBUSxTQUFTO0lBeUJxQjtJQXhCdkMsTUFBTSxDQUFVLElBQUksR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUM1QixNQUFNLENBQVUsYUFBYSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ3JDLE1BQU0sQ0FBVSxhQUFhLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDckMsTUFBTSxDQUFVLGFBQWEsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUNyQyxNQUFNLENBQVUsY0FBYyxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ3RD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QUFDLGNBQWMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQU9ELE9BQU8sQ0FBQyxPQUF1QztRQUM5QyxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBT0QsY0FBYyxDQUNiLE9BQW1FO1FBRW5FLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ2hELENBQUM7SUFPRCxlQUFlLENBQ2QsT0FBbUU7UUFFbkUsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxjQUFjLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQU9ELHNCQUFzQixDQUNyQixPQUFtRTtRQUVuRSxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLDBCQUEwQixFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFPRCxjQUFjLENBQ2IsT0FBNkQ7UUFFN0QsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQU9ELE1BQU0sQ0FBQyxNQUFNLENBQ1osT0FBZ0I7UUFFaEIsT0FBTyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM3QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9XZWJDb25maWdzIGZyb20gJy4vT1dlYkNvbmZpZ3MnO1xuaW1wb3J0IE9XZWJEYXRhU3RvcmUsIHsgT0pTT05WYWx1ZSB9IGZyb20gJy4vT1dlYkRhdGFTdG9yZSc7XG5pbXBvcnQgT1dlYkV2ZW50IGZyb20gJy4vT1dlYkV2ZW50JztcbmltcG9ydCBPV2ViRm9ybSwgeyBPV2ViRm9ybU9wdGlvbnMgfSBmcm9tICcuL09XZWJGb3JtJztcbmltcG9ydCBPV2ViUm91dGVyLCB7IE9Sb3V0ZVN0YXRlT2JqZWN0LCBPUm91dGVUYXJnZXQgfSBmcm9tICcuL09XZWJSb3V0ZXInO1xuaW1wb3J0IE9XZWJVcmwgZnJvbSAnLi9PV2ViVXJsJztcbmltcG9ydCBPV2ViVmlldyBmcm9tICcuL09XZWJWaWV3JztcbmltcG9ydCBPV2ViSTE4biBmcm9tICcuL09XZWJJMThuJztcbmltcG9ydCB7IGFzc2lnbiwgaWQsIGxvZ2dlciB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IE9ab25lIGZyb20gJy4vb3pvbmUnO1xuaW1wb3J0IE9XZWJQYWdlciwgeyBPUGFnZSB9IGZyb20gJy4vT1dlYlBhZ2VyJztcbmltcG9ydCBPV2ViVXNlciBmcm9tICcuL09XZWJVc2VyJztcbmltcG9ydCB7IE9OZXRSZXF1ZXN0T3B0aW9ucyB9IGZyb20gJy4vT1dlYk5ldCc7XG5pbXBvcnQgT1dlYlhIUiBmcm9tICcuL09XZWJYSFInO1xuaW1wb3J0IGRlZmF1bHRBcHBDb25maWdzIGZyb20gJy4vZGVmYXVsdC9hcHAuY29uZmlncyc7XG5pbXBvcnQgZGVmYXVsdFVzZXJDb25maWdzIGZyb20gJy4vZGVmYXVsdC91c2VyLmNvbmZpZ3MnO1xuaW1wb3J0IGRlZmF1bHRBcHBVcmxzIGZyb20gJy4vZGVmYXVsdC9hcHAudXJscyc7XG5pbXBvcnQgeyBPRm9ybURPTUZvcm1BZGFwdGVyLCBPRm9ybU9iamVjdEFkYXB0ZXIgfSBmcm9tICcuL09XZWJGb3JtQWRhcHRlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT1VybExpc3Qge1xuXHRba2V5OiBzdHJpbmddOiBzdHJpbmc7XG5cblx0T1pfU0VSVkVSX0dFVF9GSUxFX1VSSTogc3RyaW5nO1xuXHRPWl9TRVJWRVJfVE5FVF9TRVJWSUNFOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9MT0dJTl9TRVJWSUNFOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9MT0dPVVRfU0VSVklDRTogc3RyaW5nO1xuXHRPWl9TRVJWRVJfU0lHTlVQX1NFUlZJQ0U6IHN0cmluZztcblx0T1pfU0VSVkVSX0FDQ09VTlRfUkVDT1ZFUllfU0VSVklDRTogc3RyaW5nO1xuXHRPWl9TRVJWRVJfUEFTU1dPUkRfU0VSVklDRTogc3RyaW5nO1xuXHRPWl9TRVJWRVJfQ0FQVENIQV9TRVJWSUNFOiBzdHJpbmc7XG5cdE9aX1NFUlZFUl9VUExPQURfU0VSVklDRTogc3RyaW5nO1xuXG5cdE9XX0FQUF9QQVRIX1NJR05fVVA6IHN0cmluZztcblx0T1dfQVBQX1BBVEhfTE9HT1VUOiBzdHJpbmc7XG5cdE9XX0FQUF9QQVRIX0xPR0lOOiBzdHJpbmc7XG5cdE9XX0FQUF9QQVRIX0hPTUU6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPQXBwQ29uZmlncyB7XG5cdFtrZXk6IHN0cmluZ106IE9KU09OVmFsdWU7XG5cblx0T1dfQVBQX05BTUU6IHN0cmluZztcblx0T1dfQVBQX1ZFUlNJT046IHN0cmluZztcblx0T1dfQVBQX0xPQ0FMX0JBU0VfVVJMOiBzdHJpbmc7XG5cdE9XX0FQUF9ST1VURVJfSEFTSF9NT0RFOiBib29sZWFuO1xuXHRPV19BUFBfQUxMT1dFRF9DT1VOVFJJRVM6IHN0cmluZ1tdO1xuXG5cdE9aX0FQSV9LRVk6IHN0cmluZztcblx0T1pfQVBJX0tFWV9IRUFERVJfTkFNRTogc3RyaW5nO1xuXHRPWl9BUElfQUxMT1dfUkVBTF9NRVRIT0RfSEVBREVSOiBib29sZWFuO1xuXHRPWl9BUElfUkVBTF9NRVRIT0RfSEVBREVSX05BTUU6IHN0cmluZztcblx0T1pfQVBJX0JBU0VfVVJMOiBzdHJpbmc7XG5cblx0T1pfQ09ERV9SRUc6IHN0cmluZztcblx0T1pfVVNFUl9OQU1FX01JTl9MRU5HVEg6IG51bWJlcjtcblx0T1pfVVNFUl9OQU1FX01BWF9MRU5HVEg6IG51bWJlcjtcblx0T1pfUEFTU19NSU5fTEVOR1RIOiBudW1iZXI7XG5cdE9aX1BBU1NfTUFYX0xFTkdUSDogbnVtYmVyO1xuXHRPWl9VU0VSX01JTl9BR0U6IG51bWJlcjtcblx0T1pfVVNFUl9NQVhfQUdFOiBudW1iZXI7XG5cdE9aX1BQSUNfTUlOX1NJWkU6IG51bWJlcjtcblx0T1pfVVNFUl9BTExPV0VEX0dFTkRFUlM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9Vc2VyQ29uZmlncyB7XG5cdFtrZXk6IHN0cmluZ106IE9KU09OVmFsdWU7XG5cblx0T1dfQVBQX0RFRkFVTFRfTEFORzogc3RyaW5nO1xuXHRPV19BUFBfQ09VTlRSWTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9TdG9yZSB7XG5cdFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IHR5cGUgT1VzZXIgPSB7XG5cdFtrZXk6IHN0cmluZ106IGFueTtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgT0FwcE9wdGlvbnM8XG5cdFN0b3JlIGV4dGVuZHMgT1N0b3JlLFxuXHRQYWdlIGV4dGVuZHMgT1BhZ2UsXG5cdFVzZXIgZXh0ZW5kcyBPVXNlclxuPiB7XG5cdG5hbWU6IHN0cmluZztcblx0YXBwQ29uZmlnczogUGFydGlhbDxPQXBwQ29uZmlncz47XG5cdHVzZXJDb25maWdzOiBQYXJ0aWFsPE9Vc2VyQ29uZmlncz47XG5cdHVybHM6IFBhcnRpYWw8T1VybExpc3Q+O1xuXHR1c2VyOiAoXG5cdFx0dGhpczogT1dlYkFwcDxTdG9yZSwgUGFnZSwgVXNlciwgT0FwcE9wdGlvbnM8U3RvcmUsIFBhZ2UsIFVzZXI+PlxuXHQpID0+IE9XZWJVc2VyPFVzZXI+O1xuXHRzdG9yZTogKFxuXHRcdHRoaXM6IE9XZWJBcHA8U3RvcmUsIFBhZ2UsIFVzZXIsIE9BcHBPcHRpb25zPFN0b3JlLCBQYWdlLCBVc2VyPj5cblx0KSA9PiBTdG9yZTtcblx0cGFnZXI6IChcblx0XHR0aGlzOiBPV2ViQXBwPFN0b3JlLCBQYWdlLCBVc2VyLCBPQXBwT3B0aW9uczxTdG9yZSwgUGFnZSwgVXNlcj4+XG5cdCkgPT4gT1dlYlBhZ2VyPFBhZ2U+O1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPV2ViQXBwPFxuXHRTdG9yZSBleHRlbmRzIE9TdG9yZSA9IGFueSxcblx0UGFnZSBleHRlbmRzIE9QYWdlID0gYW55LFxuXHRVc2VyIGV4dGVuZHMgT1VzZXIgPSBhbnksXG5cdE9wdGlvbnMgZXh0ZW5kcyBPQXBwT3B0aW9uczxTdG9yZSwgUGFnZSwgVXNlcj4gPSBhbnlcbj4gZXh0ZW5kcyBPV2ViRXZlbnQge1xuXHRzdGF0aWMgcmVhZG9ubHkgU0VMRiA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfQVBQX1JFQURZID0gaWQoKTtcblx0c3RhdGljIHJlYWRvbmx5IEVWVF9OT1RfRk9VTkQgPSBpZCgpO1xuXHRzdGF0aWMgcmVhZG9ubHkgRVZUX1NIT1dfSE9NRSA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfU0hPV19MT0dJTiA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfU0hPV19SRUdJU1RSQVRJT05fUEFHRSA9IGlkKCk7XG5cblx0cmVhZG9ubHkgdmlldzogT1dlYlZpZXc7XG5cdHJlYWRvbmx5IGxzOiBPV2ViRGF0YVN0b3JlO1xuXHRyZWFkb25seSByb3V0ZXI6IE9XZWJSb3V0ZXI7XG5cdHJlYWRvbmx5IHVzZXI6IE9XZWJVc2VyPFVzZXI+O1xuXHRyZWFkb25seSBjb25maWdzOiBPV2ViQ29uZmlnczxPQXBwQ29uZmlncywgT1VzZXJDb25maWdzPjtcblx0cmVhZG9ubHkgdXJsOiBPV2ViVXJsO1xuXHRyZWFkb25seSBpMThuOiBPV2ViSTE4bjtcblx0cmVhZG9ubHkgb3o6IE9ab25lO1xuXG5cdHByaXZhdGUgcmVhZG9ubHkgX3N0b3JlOiBTdG9yZTtcblx0cHJpdmF0ZSByZWFkb25seSBfcGFnZXI6IE9XZWJQYWdlcjxQYWdlPjtcblxuXHQvKipcblx0ICogT1dlYkFwcCBjb25zdHJ1Y3Rvci5cblx0ICpcblx0ICogQHBhcmFtIG9wdGlvbnNcblx0ICovXG5cdHByb3RlY3RlZCBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IG9wdGlvbnM6IE9wdGlvbnMpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5scyA9IG5ldyBPV2ViRGF0YVN0b3JlKHRoaXMpO1xuXHRcdHRoaXMuY29uZmlncyA9IG5ldyBPV2ViQ29uZmlncyhcblx0XHRcdHRoaXMsXG5cdFx0XHRhc3NpZ24oe30sIGRlZmF1bHRBcHBDb25maWdzLCBvcHRpb25zLmFwcENvbmZpZ3MpLFxuXHRcdFx0YXNzaWduKHt9LCBkZWZhdWx0VXNlckNvbmZpZ3MsIG9wdGlvbnMudXNlckNvbmZpZ3MpXG5cdFx0KTtcblx0XHR0aGlzLnVybCA9IG5ldyBPV2ViVXJsKHRoaXMsIGFzc2lnbih7fSwgZGVmYXVsdEFwcFVybHMsIG9wdGlvbnMudXJscykpO1xuXHRcdHRoaXMudmlldyA9IG5ldyBPV2ViVmlldygpO1xuXHRcdHRoaXMuaTE4biA9IG5ldyBPV2ViSTE4bigpO1xuXHRcdHRoaXMudXNlciA9IG9wdGlvbnMudXNlci5jYWxsKHRoaXMpO1xuXHRcdHRoaXMuX3N0b3JlID0gb3B0aW9ucy5zdG9yZS5jYWxsKHRoaXMpO1xuXHRcdHRoaXMuX3BhZ2VyID0gb3B0aW9ucy5wYWdlci5jYWxsKHRoaXMpO1xuXG5cdFx0Y29uc3QgY3R4ID0gdGhpcyxcblx0XHRcdGJhc2VVcmwgPSB0aGlzLmNvbmZpZ3MuZ2V0KCdPV19BUFBfTE9DQUxfQkFTRV9VUkwnKSxcblx0XHRcdGhhc2hNb2RlID0gdGhpcy5jb25maWdzLmdldCgnT1dfQVBQX1JPVVRFUl9IQVNIX01PREUnKTtcblxuXHRcdHRoaXMucm91dGVyID0gbmV3IE9XZWJSb3V0ZXIoYmFzZVVybCwgaGFzaE1vZGUsIGZ1bmN0aW9uIG5vdEZvdW5kSGFuZGxlcihcblx0XHRcdHRhcmdldDogT1JvdXRlVGFyZ2V0XG5cdFx0KSB7XG5cdFx0XHRjdHgudHJpZ2dlcihPV2ViQXBwLkVWVF9OT1RfRk9VTkQsIFt0YXJnZXRdKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuaTE4bi5zZXREZWZhdWx0TGFuZyh0aGlzLmNvbmZpZ3MuZ2V0KCdPV19BUFBfREVGQVVMVF9MQU5HJykpO1xuXG5cdFx0dGhpcy5veiA9IE9ab25lLmluc3RhbnRpYXRlKHRoaXMpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEJ1aWxkIGFuIEhUVFAgcmVxdWVzdC5cblx0ICpcblx0ICogQHBhcmFtIHVybFxuXHQgKiBAcGFyYW0gb3B0aW9uc1xuXHQgKi9cblx0cmVxdWVzdDxSZXNwb25zZT4oXG5cdFx0dXJsOiBzdHJpbmcsXG5cdFx0b3B0aW9uczogUGFydGlhbDxPTmV0UmVxdWVzdE9wdGlvbnM8UmVzcG9uc2U+PiA9IHt9XG5cdCk6IE9XZWJYSFI8UmVzcG9uc2U+IHtcblx0XHRsb2dnZXIuZGVidWcoJ1tOZXRdIG5ldyByZXF1ZXN0JywgdXJsLCBvcHRpb25zKTtcblxuXHRcdGNvbnN0IGV2ZW50ID0gZnVuY3Rpb24gZXZlbnQodHlwZTogc3RyaW5nKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gZXZlbnRIYW5kbGVyKC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG5cdFx0XHRcdGxvZ2dlci5kZWJ1ZygnW05ldF0gZXZlbnQgJXMnLCB0eXBlLCB1cmwsIG9wdGlvbnMsIGFyZ3MpO1xuXHRcdFx0fTtcblx0XHR9O1xuXG5cdFx0Y29uc3QgbyA9IG5ldyBPV2ViWEhSPFJlc3BvbnNlPih1cmwsIHtcblx0XHRcdHdpdGhDcmVkZW50aWFsczogdHJ1ZSxcblx0XHRcdC4uLm9wdGlvbnMsXG5cdFx0fSk7XG5cblx0XHRvLm9uRmluaXNoKGV2ZW50KCdvbkZpbmlzaGVkJykpXG5cdFx0XHQub25FcnJvcihldmVudCgnb25FcnJvcicpKVxuXHRcdFx0Lm9uRmFpbChldmVudCgnb25GYWlsZWQnKSlcblx0XHRcdC5vbkh0dHBFcnJvcihldmVudCgnb25IdHRwRXJyb3InKSlcblx0XHRcdC5vbkh0dHBTdWNjZXNzKGV2ZW50KCdvbkh0dHBTdWNjZXNzJykpXG5cdFx0XHQub25Hb29kTmV3cyhldmVudCgnb25Hb29kTmV3cycpKVxuXHRcdFx0Lm9uQmFkTmV3cyhldmVudCgnb25CYWROZXdzJykpXG5cdFx0XHQub25Eb3dubG9hZFByb2dyZXNzKGV2ZW50KCdvbkRvd25sb2FkUHJvZ3Jlc3MnKSlcblx0XHRcdC5vblVwbG9hZFByb2dyZXNzKGV2ZW50KCdvblVwbG9hZFByb2dyZXNzJykpXG5cdFx0XHQub25SZXNwb25zZShldmVudCgnb25SZXNwb25zZScpKTtcblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0LyoqXG5cdCAqIFN0b3JlIGdldHRlci5cblx0ICovXG5cdGdldCBzdG9yZSgpOiBSZXR1cm5UeXBlPE9wdGlvbnNbJ3N0b3JlJ10+IHtcblx0XHRyZXR1cm4gdGhpcy5fc3RvcmUgYXMgYW55O1xuXHR9XG5cblx0LyoqXG5cdCAqIFBhZ2VyIGluc3RhbmNlIGdldHRlci5cblx0ICovXG5cdGdldCBwYWdlcigpOiBSZXR1cm5UeXBlPE9wdGlvbnNbJ3BhZ2VyJ10+IHtcblx0XHRyZXR1cm4gdGhpcy5fcGFnZXIgYXMgYW55O1xuXHR9XG5cblx0LyoqXG5cdCAqIEFwcCBuYW1lIGdldHRlci5cblx0ICovXG5cdGdldEFwcE5hbWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLm5hbWU7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2tzIGlmIHdlIGFyZSBydW5uaW5nIGluIG1vYmlsZSBhcHAuXG5cdCAqL1xuXHRpc01vYmlsZUFwcCgpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gJ2NvcmRvdmEnIGluIHdpbmRvdztcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIG5ldyBvd2ViIGZvcm0gaW5zdGFuY2UuXG5cdCAqXG5cdCAqIEBwYXJhbSBmb3JtIFRoZSBodG1sIGZvcm0gZWxlbWVudC5cblx0ICogQHBhcmFtIHJlcXVpcmVkIFRoZSByZXF1aXJlZCBmaWVsZHMgbmFtZXMgbGlzdC5cblx0ICogQHBhcmFtIGV4Y2x1ZGVkIFRoZSBmaWVsZHMgbmFtZXMgdG8gZXhjbHVkZS5cblx0ICogQHBhcmFtIGNoZWNrQWxsIEZvcmNlIHRoZSB2YWxpZGF0b3IgdG8gY2hlY2sgYWxsIGZpZWxkcy5cblx0ICogQHBhcmFtIHZlcmJvc2UgTG9nIHdhcm5pbmcuXG5cdCAqL1xuXHRmb3JtKFxuXHRcdGZvcm06IE9XZWJGb3JtT3B0aW9ucyB8IEhUTUxGb3JtRWxlbWVudCxcblx0XHRyZXF1aXJlZDogc3RyaW5nW10gPSBbXSxcblx0XHRleGNsdWRlZDogc3RyaW5nW10gPSBbXSxcblx0XHRjaGVja0FsbCA9IGZhbHNlLFxuXHRcdHZlcmJvc2UgPSBmYWxzZVxuXHQpOiBPV2ViRm9ybSB7XG5cdFx0cmV0dXJuIG5ldyBPV2ViRm9ybShcblx0XHRcdHRoaXMsXG5cdFx0XHRmb3JtIGluc3RhbmNlb2YgSFRNTEZvcm1FbGVtZW50XG5cdFx0XHRcdD8gbmV3IE9Gb3JtRE9NRm9ybUFkYXB0ZXIoZm9ybSlcblx0XHRcdFx0OiBuZXcgT0Zvcm1PYmplY3RBZGFwdGVyKGZvcm0pLFxuXHRcdFx0cmVxdWlyZWQsXG5cdFx0XHRleGNsdWRlZCxcblx0XHRcdGNoZWNrQWxsLFxuXHRcdFx0dmVyYm9zZVxuXHRcdCk7XG5cdH1cblxuXHQvKipcblx0ICogRm9yY2UgbG9naW4uXG5cdCAqXG5cdCAqID4gVGhpcyB3aWxsIGNsZWFyIGFsbCBzYXZlZCBkYXRhIGluIHRoZSBsb2NhbCBzdG9yYWdlLlxuXHQgKi9cblx0Zm9yY2VMb2dpbigpOiB2b2lkIHtcblx0XHR0aGlzLmxzLmNsZWFyKCk7XG5cdFx0dGhpcy5zaG93TG9naW5QYWdlKHt9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWxvYWQgdGhlIGFwcC5cblx0ICovXG5cdHJlbG9hZEFwcCgpOiB2b2lkIHtcblx0XHQvLyBUT0RPOiBpbnN0ZWFkIG9mIHJlbG9hZGluZyB0aGUgY3VycmVudCBsb2NhdGlvbiwgZmluZCBhIHdheSB0byBicm93c2UgdG8gd2ViIGFwcCBlbnRyeSBwb2ludFxuXHRcdC8vIGZvciBhbmRyb2lkICYgaW9zIHJlc3RhcnQgdGhlIGFwcFxuXHRcdC8vIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7XG5cdFx0dGhpcy5zaG93SG9tZVBhZ2Uoe30pO1xuXHR9XG5cblx0LyoqXG5cdCAqIERlc3Ryb3kgdGhlIGFwcC5cblx0ICpcblx0ICogPiBUaGlzIHdpbGwgY2xlYXIgYWxsIHNhdmVkIGRhdGEgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG5cdCAqL1xuXHRkZXN0cm95QXBwKCk6IHZvaWQge1xuXHRcdC8vIGVyYXNlIGRhdGFcblx0XHR0aGlzLmxzLmNsZWFyKCk7XG5cdFx0dGhpcy5yZWxvYWRBcHAoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDbG9zZSBhcHAuXG5cdCAqL1xuXHRjbG9zZUFwcCgpOiB2b2lkIHtcblx0XHQvLyBjb3Jkb3ZhXG5cdFx0aWYgKHdpbmRvdy5uYXZpZ2F0b3IgJiYgKHdpbmRvdy5uYXZpZ2F0b3IgYXMgYW55KS5hcHApIHtcblx0XHRcdCh3aW5kb3cubmF2aWdhdG9yIGFzIGFueSkuYXBwLmV4aXRBcHAoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0d2luZG93LmNsb3NlKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFRvIHN0YXJ0IHRoZSB3ZWIgYXBwLlxuXHQgKi9cblx0c3RhcnQoKTogdGhpcyB7XG5cdFx0bG9nZ2VyLmluZm8oJ1tPV2ViQXBwXSBhcHAgc3RhcnRlZCEnKTtcblx0XHR0aGlzLnRyaWdnZXIoT1dlYkFwcC5FVlRfQVBQX1JFQURZKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgd2hlbiBhcHAgc2hvdWxkIHNob3cgdGhlIGhvbWUgcGFnZS5cblx0ICovXG5cdHNob3dIb21lUGFnZShvcHRpb25zOiBPUm91dGVTdGF0ZU9iamVjdCA9IHt9KTogdm9pZCB7XG5cdFx0dGhpcy50cmlnZ2VyKE9XZWJBcHAuRVZUX1NIT1dfSE9NRSwgW29wdGlvbnNdKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgd2hlbiBhcHAgc2hvdWxkIHNob3cgdGhlIGxvZ2luIHBhZ2UuXG5cdCAqL1xuXHRzaG93TG9naW5QYWdlKG9wdGlvbnM6IE9Sb3V0ZVN0YXRlT2JqZWN0ID0ge30pOiB2b2lkIHtcblx0XHR0aGlzLnRyaWdnZXIoT1dlYkFwcC5FVlRfU0hPV19MT0dJTiwgW29wdGlvbnNdKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgd2hlbiBhcHAgc2hvdWxkIHNob3cgdGhlIHJlZ2lzdHJhdGlvbiBwYWdlLlxuXHQgKi9cblx0c2hvd1JlZ2lzdHJhdGlvblBhZ2Uob3B0aW9uczogT1JvdXRlU3RhdGVPYmplY3QgPSB7fSk6IHZvaWQge1xuXHRcdHRoaXMudHJpZ2dlcihPV2ViQXBwLkVWVF9TSE9XX0xPR0lOLCBbb3B0aW9uc10pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGhhbmRsZXIgZm9yIE9XZWJBcHAuRVZUX0FQUF9SRUFEWSBldmVudFxuXHQgKlxuXHQgKiBAcGFyYW0gaGFuZGxlclxuXHQgKi9cblx0b25SZWFkeShoYW5kbGVyOiAodGhpczogdGhpcykgPT4gdm9pZCB8IGJvb2xlYW4pOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViQXBwLkVWVF9BUFBfUkVBRFksIGhhbmRsZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGhhbmRsZXIgZm9yIE9XZWJBcHAuRVZUX1NIT1dfSE9NRSBldmVudFxuXHQgKlxuXHQgKiBAcGFyYW0gaGFuZGxlclxuXHQgKi9cblx0b25TaG93SG9tZVBhZ2UoXG5cdFx0aGFuZGxlcjogKHRoaXM6IHRoaXMsIG9wdGlvbnM6IE9Sb3V0ZVN0YXRlT2JqZWN0KSA9PiB2b2lkIHwgYm9vbGVhblxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViQXBwLkVWVF9TSE9XX0hPTUUsIGhhbmRsZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGhhbmRsZXIgZm9yIE9XZWJBcHAuRVZUX1NIT1dfTE9HSU4gZXZlbnRcblx0ICpcblx0ICogQHBhcmFtIGhhbmRsZXJcblx0ICovXG5cdG9uU2hvd0xvZ2luUGFnZShcblx0XHRoYW5kbGVyOiAodGhpczogdGhpcywgb3B0aW9uczogT1JvdXRlU3RhdGVPYmplY3QpID0+IHZvaWQgfCBib29sZWFuXG5cdCk6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJBcHAuRVZUX1NIT1dfTE9HSU4sIGhhbmRsZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGhhbmRsZXIgZm9yIE9XZWJBcHAuRVZUX1NIT1dfUkVHSVNUUkFUSU9OX1BBR0UgZXZlbnRcblx0ICpcblx0ICogQHBhcmFtIGhhbmRsZXJcblx0ICovXG5cdG9uU2hvd1JlZ2lzdHJhdGlvblBhZ2UoXG5cdFx0aGFuZGxlcjogKHRoaXM6IHRoaXMsIG9wdGlvbnM6IE9Sb3V0ZVN0YXRlT2JqZWN0KSA9PiB2b2lkIHwgYm9vbGVhblxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViQXBwLkVWVF9TSE9XX1JFR0lTVFJBVElPTl9QQUdFLCBoYW5kbGVyKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWdpc3RlciBoYW5kbGVyIGZvciBPV2ViQXBwLkVWVF9OT1RfRk9VTkQgZXZlbnRcblx0ICpcblx0ICogQHBhcmFtIGhhbmRsZXJcblx0ICovXG5cdG9uUGFnZU5vdEZvdW5kKFxuXHRcdGhhbmRsZXI6ICh0aGlzOiB0aGlzLCB0YXJnZXQ6IE9Sb3V0ZVRhcmdldCkgPT4gdm9pZCB8IGJvb2xlYW5cblx0KTogdGhpcyB7XG5cdFx0cmV0dXJuIHRoaXMub24oT1dlYkFwcC5FVlRfTk9UX0ZPVU5ELCBoYW5kbGVyKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIG5ldyBhcHAgaW5zdGFuY2UuXG5cdCAqXG5cdCAqIEBwYXJhbSBvcHRpb25zXG5cdCAqL1xuXHRzdGF0aWMgY3JlYXRlPE9wdGlvbnMgZXh0ZW5kcyBPQXBwT3B0aW9uczxPU3RvcmUsIE9QYWdlLCBPVXNlcj4gPSBhbnk+KFxuXHRcdG9wdGlvbnM6IE9wdGlvbnNcblx0KTogT1dlYkFwcDxhbnksIGFueSwgYW55LCBPcHRpb25zPiB7XG5cdFx0cmV0dXJuIG5ldyBPV2ViQXBwKG9wdGlvbnMpO1xuXHR9XG59XG4iXX0=