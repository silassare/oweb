import OWebEvent from '../OWebEvent';
import { id } from '../utils';
export default class OWebLogout extends OWebEvent {
    _appContext;
    static SELF = id();
    static EVT_LOGOUT_FAIL = id();
    static EVT_LOGOUT_SUCCESS = id();
    constructor(_appContext) {
        super();
        this._appContext = _appContext;
    }
    onLogoutFail(handler) {
        return this.on(OWebLogout.EVT_LOGOUT_FAIL, handler);
    }
    onLogoutSuccess(handler) {
        return this.on(OWebLogout.EVT_LOGOUT_SUCCESS, handler);
    }
    logout() {
        const m = this, url = m._appContext.url.get('OZ_SERVER_LOGOUT_SERVICE'), net = m._appContext.oz.request(url, {
            method: 'POST',
        });
        return net
            .onGoodNews(function goodNewsHandler(response) {
            m.trigger(OWebLogout.EVT_LOGOUT_SUCCESS, [response]);
        })
            .onFail(function failHandler(err) {
            m.trigger(OWebLogout.EVT_LOGOUT_FAIL, [err]);
        })
            .send();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYkxvZ291dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wbHVnaW5zL09XZWJMb2dvdXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxTQUFTLE1BQU0sY0FBYyxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFJOUIsTUFBTSxDQUFDLE9BQU8sT0FBTyxVQUFtQixTQUFRLFNBQVM7SUFLM0I7SUFKN0IsTUFBTSxDQUFVLElBQUksR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUM1QixNQUFNLENBQVUsZUFBZSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ3ZDLE1BQU0sQ0FBVSxrQkFBa0IsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUUxQyxZQUE2QixXQUFvQjtRQUNoRCxLQUFLLEVBQUUsQ0FBQztRQURvQixnQkFBVyxHQUFYLFdBQVcsQ0FBUztJQUVqRCxDQUFDO0lBRUQsWUFBWSxDQUFDLE9BQTZDO1FBQ3pELE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsZUFBZSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3JELENBQUM7SUFFRCxlQUFlLENBQ2QsT0FBMkU7UUFFM0UsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRUQsTUFBTTtRQUNMLE1BQU0sQ0FBQyxHQUFHLElBQUksRUFDYixHQUFHLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDLEVBQ3ZELEdBQUcsR0FBRyxDQUFDLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQW9CLEdBQUcsRUFBRTtZQUN0RCxNQUFNLEVBQUUsTUFBTTtTQUNkLENBQUMsQ0FBQztRQUVKLE9BQU8sR0FBRzthQUNSLFVBQVUsQ0FBQyxTQUFTLGVBQWUsQ0FBQyxRQUFRO1lBQzVDLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLGtCQUFrQixFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUN0RCxDQUFDLENBQUM7YUFDRCxNQUFNLENBQUMsU0FBUyxXQUFXLENBQUMsR0FBRztZQUMvQixDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzlDLENBQUMsQ0FBQzthQUNELElBQUksRUFBRSxDQUFDO0lBQ1YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPV2ViQXBwIGZyb20gJy4uL09XZWJBcHAnO1xuaW1wb3J0IE9XZWJFdmVudCBmcm9tICcuLi9PV2ViRXZlbnQnO1xuaW1wb3J0IHsgaWQgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBPTmV0RXJyb3IsIE9OZXRSZXNwb25zZSB9IGZyb20gJy4uL09XZWJOZXQnO1xuaW1wb3J0IHsgT0FwaVJlc3BvbnNlIH0gZnJvbSAnLi4vb3pvbmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPV2ViTG9nb3V0PFJlc3VsdD4gZXh0ZW5kcyBPV2ViRXZlbnQge1xuXHRzdGF0aWMgcmVhZG9ubHkgU0VMRiA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfTE9HT1VUX0ZBSUwgPSBpZCgpO1xuXHRzdGF0aWMgcmVhZG9ubHkgRVZUX0xPR09VVF9TVUNDRVNTID0gaWQoKTtcblxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IF9hcHBDb250ZXh0OiBPV2ViQXBwKSB7XG5cdFx0c3VwZXIoKTtcblx0fVxuXG5cdG9uTG9nb3V0RmFpbChoYW5kbGVyOiAodGhpczogdGhpcywgZXJyOiBPTmV0RXJyb3IpID0+IHZvaWQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfRkFJTCwgaGFuZGxlcik7XG5cdH1cblxuXHRvbkxvZ291dFN1Y2Nlc3MoXG5cdFx0aGFuZGxlcjogKHRoaXM6IHRoaXMsIHJlc3BvbnNlOiBPTmV0UmVzcG9uc2U8T0FwaVJlc3BvbnNlPFJlc3VsdD4+KSA9PiB2b2lkXG5cdCk6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJMb2dvdXQuRVZUX0xPR09VVF9TVUNDRVNTLCBoYW5kbGVyKTtcblx0fVxuXG5cdGxvZ291dCgpOiBQcm9taXNlPE9OZXRSZXNwb25zZTxPQXBpUmVzcG9uc2U8UmVzdWx0Pj4+IHtcblx0XHRjb25zdCBtID0gdGhpcyxcblx0XHRcdHVybCA9IG0uX2FwcENvbnRleHQudXJsLmdldCgnT1pfU0VSVkVSX0xPR09VVF9TRVJWSUNFJyksXG5cdFx0XHRuZXQgPSBtLl9hcHBDb250ZXh0Lm96LnJlcXVlc3Q8T0FwaVJlc3BvbnNlPGFueT4+KHVybCwge1xuXHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdH0pO1xuXG5cdFx0cmV0dXJuIG5ldFxuXHRcdFx0Lm9uR29vZE5ld3MoZnVuY3Rpb24gZ29vZE5ld3NIYW5kbGVyKHJlc3BvbnNlKSB7XG5cdFx0XHRcdG0udHJpZ2dlcihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfU1VDQ0VTUywgW3Jlc3BvbnNlXSk7XG5cdFx0XHR9KVxuXHRcdFx0Lm9uRmFpbChmdW5jdGlvbiBmYWlsSGFuZGxlcihlcnIpIHtcblx0XHRcdFx0bS50cmlnZ2VyKE9XZWJMb2dvdXQuRVZUX0xPR09VVF9GQUlMLCBbZXJyXSk7XG5cdFx0XHR9KVxuXHRcdFx0LnNlbmQoKTtcblx0fVxufVxuIl19