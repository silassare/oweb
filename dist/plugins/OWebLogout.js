import OWebEvent from '../OWebEvent';
import { id } from '../utils';
export default class OWebLogout extends OWebEvent {
    constructor(_appContext) {
        super();
        this._appContext = _appContext;
    }
    onLogoutFail(handler) {
        return this.on(OWebLogout.EVT_LOGOUT_FAIL, handler);
    }
    onLogoutSuccess(handler) {
        return this.on(OWebLogout.EVT_LOGOUT_SUCCESS, handler);
    }
    logout() {
        const m = this, url = m._appContext.url.get('OZ_SERVER_LOGOUT_SERVICE'), net = m._appContext.oz.request(url, {
            method: 'POST',
        });
        return net
            .onGoodNews(function (response) {
            m.trigger(OWebLogout.EVT_LOGOUT_SUCCESS, [response]);
        })
            .onFail(function (err) {
            m.trigger(OWebLogout.EVT_LOGOUT_FAIL, [err]);
        })
            .send();
    }
}
OWebLogout.SELF = id();
OWebLogout.EVT_LOGOUT_FAIL = id();
OWebLogout.EVT_LOGOUT_SUCCESS = id();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYkxvZ291dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wbHVnaW5zL09XZWJMb2dvdXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxTQUFTLE1BQU0sY0FBYyxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFJOUIsTUFBTSxDQUFDLE9BQU8sT0FBTyxVQUFXLFNBQVEsU0FBUztJQUtoRCxZQUE2QixXQUFvQjtRQUNoRCxLQUFLLEVBQUUsQ0FBQztRQURvQixnQkFBVyxHQUFYLFdBQVcsQ0FBUztJQUVqRCxDQUFDO0lBRUQsWUFBWSxDQUNYLE9BQTZDO1FBRTdDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsZUFBZSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3JELENBQUM7SUFFRCxlQUFlLENBQ2QsT0FHUztRQUVULE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUVELE1BQU07UUFDTCxNQUFNLENBQUMsR0FBRyxJQUFJLEVBQ2IsR0FBRyxHQUFHLENBQUMsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsQ0FBQyxFQUN2RCxHQUFHLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFnQixHQUFHLEVBQUU7WUFDbEQsTUFBTSxFQUFFLE1BQU07U0FDZCxDQUFDLENBQUM7UUFFSixPQUFPLEdBQUc7YUFDUixVQUFVLENBQUMsVUFBVSxRQUFRO1lBQzdCLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLGtCQUFrQixFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUN0RCxDQUFDLENBQUM7YUFDRCxNQUFNLENBQUMsVUFBVSxHQUFHO1lBQ3BCLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDO2FBQ0QsSUFBSSxFQUFFLENBQUM7SUFDVixDQUFDOztBQXRDZSxlQUFJLEdBQWlCLEVBQUUsRUFBRSxDQUFDO0FBQzFCLDBCQUFlLEdBQU0sRUFBRSxFQUFFLENBQUM7QUFDMUIsNkJBQWtCLEdBQUcsRUFBRSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgT1dlYkFwcCBmcm9tICcuLi9PV2ViQXBwJztcbmltcG9ydCBPV2ViRXZlbnQgZnJvbSAnLi4vT1dlYkV2ZW50JztcbmltcG9ydCB7IGlkIH0gZnJvbSAnLi4vdXRpbHMnO1xuaW1wb3J0IHtPTmV0RXJyb3IsIE9OZXRSZXNwb25zZX0gZnJvbSAnLi4vT1dlYk5ldCc7XG5pbXBvcnQgeyBPQXBpSlNPTiB9IGZyb20gJy4uL296b25lJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT1dlYkxvZ291dCBleHRlbmRzIE9XZWJFdmVudCB7XG5cdHN0YXRpYyByZWFkb25seSBTRUxGICAgICAgICAgICAgICAgPSBpZCgpO1xuXHRzdGF0aWMgcmVhZG9ubHkgRVZUX0xPR09VVF9GQUlMICAgID0gaWQoKTtcblx0c3RhdGljIHJlYWRvbmx5IEVWVF9MT0dPVVRfU1VDQ0VTUyA9IGlkKCk7XG5cblx0Y29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBfYXBwQ29udGV4dDogT1dlYkFwcCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRvbkxvZ291dEZhaWwoXG5cdFx0aGFuZGxlcjogKHRoaXM6IHRoaXMsIGVycjogT05ldEVycm9yKSA9PiB2b2lkLFxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfRkFJTCwgaGFuZGxlcik7XG5cdH1cblxuXHRvbkxvZ291dFN1Y2Nlc3MoXG5cdFx0aGFuZGxlcjogKFxuXHRcdFx0dGhpczogdGhpcyxcblx0XHRcdHJlc3BvbnNlOiBPTmV0UmVzcG9uc2U8T0FwaUpTT048YW55Pj4sXG5cdFx0KSA9PiB2b2lkLFxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfU1VDQ0VTUywgaGFuZGxlcik7XG5cdH1cblxuXHRsb2dvdXQoKSB7XG5cdFx0Y29uc3QgbSA9IHRoaXMsXG5cdFx0XHR1cmwgPSBtLl9hcHBDb250ZXh0LnVybC5nZXQoJ09aX1NFUlZFUl9MT0dPVVRfU0VSVklDRScpLFxuXHRcdFx0bmV0ID0gbS5fYXBwQ29udGV4dC5vei5yZXF1ZXN0PE9BcGlKU09OPGFueT4+KHVybCwge1xuXHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdH0pO1xuXG5cdFx0cmV0dXJuIG5ldFxuXHRcdFx0Lm9uR29vZE5ld3MoZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cdFx0XHRcdG0udHJpZ2dlcihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfU1VDQ0VTUywgW3Jlc3BvbnNlXSk7XG5cdFx0XHR9KVxuXHRcdFx0Lm9uRmFpbChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdG0udHJpZ2dlcihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfRkFJTCwgW2Vycl0pO1xuXHRcdFx0fSlcblx0XHRcdC5zZW5kKCk7XG5cdH1cbn1cbiJdfQ==