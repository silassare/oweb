import OWebEvent from '../OWebEvent';
import { id } from '../utils';
export default class OWebLogout extends OWebEvent {
    _appContext;
    static SELF = id();
    static EVT_LOGOUT_FAIL = id();
    static EVT_LOGOUT_SUCCESS = id();
    constructor(_appContext) {
        super();
        this._appContext = _appContext;
    }
    onLogoutFail(handler) {
        return this.on(OWebLogout.EVT_LOGOUT_FAIL, handler);
    }
    onLogoutSuccess(handler) {
        return this.on(OWebLogout.EVT_LOGOUT_SUCCESS, handler);
    }
    logout() {
        const m = this, url = m._appContext.url.get('OZ_SERVER_LOGOUT_SERVICE'), net = m._appContext.oz.request(url, {
            method: 'POST',
        });
        return net
            .onGoodNews(function goodNewsHandler(response) {
            m.trigger(OWebLogout.EVT_LOGOUT_SUCCESS, [response]);
        })
            .onFail(function failHandler(err) {
            m.trigger(OWebLogout.EVT_LOGOUT_FAIL, [err]);
        })
            .send();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYkxvZ291dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wbHVnaW5zL09XZWJMb2dvdXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxTQUFTLE1BQU0sY0FBYyxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFJOUIsTUFBTSxDQUFDLE9BQU8sT0FBTyxVQUFtQixTQUFRLFNBQVM7SUFLM0I7SUFKN0IsTUFBTSxDQUFVLElBQUksR0FBaUIsRUFBRSxFQUFFLENBQUM7SUFDMUMsTUFBTSxDQUFVLGVBQWUsR0FBTSxFQUFFLEVBQUUsQ0FBQztJQUMxQyxNQUFNLENBQVUsa0JBQWtCLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFFMUMsWUFBNkIsV0FBb0I7UUFDaEQsS0FBSyxFQUFFLENBQUM7UUFEb0IsZ0JBQVcsR0FBWCxXQUFXLENBQVM7SUFFakQsQ0FBQztJQUVELFlBQVksQ0FDWCxPQUE2QztRQUU3QyxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRUQsZUFBZSxDQUNkLE9BR1M7UUFFVCxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLGtCQUFrQixFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFRCxNQUFNO1FBQ0wsTUFBTSxDQUFDLEdBQUcsSUFBSSxFQUNiLEdBQUcsR0FBRyxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsMEJBQTBCLENBQUMsRUFDdkQsR0FBRyxHQUFHLENBQUMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBb0IsR0FBRyxFQUFFO1lBQ3RELE1BQU0sRUFBRSxNQUFNO1NBQ2QsQ0FBQyxDQUFDO1FBRUosT0FBTyxHQUFHO2FBQ1IsVUFBVSxDQUFDLFNBQVMsZUFBZSxDQUFDLFFBQVE7WUFDNUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQzthQUNELE1BQU0sQ0FBQyxTQUFTLFdBQVcsQ0FBQyxHQUFHO1lBQy9CLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDO2FBQ0QsSUFBSSxFQUFFLENBQUM7SUFDVixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9XZWJBcHAgZnJvbSAnLi4vT1dlYkFwcCc7XG5pbXBvcnQgT1dlYkV2ZW50IGZyb20gJy4uL09XZWJFdmVudCc7XG5pbXBvcnQgeyBpZCB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7T05ldEVycm9yLCBPTmV0UmVzcG9uc2V9IGZyb20gJy4uL09XZWJOZXQnO1xuaW1wb3J0IHsgT0FwaVJlc3BvbnNlIH0gZnJvbSAnLi4vb3pvbmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPV2ViTG9nb3V0PFJlc3VsdD4gZXh0ZW5kcyBPV2ViRXZlbnQge1xuXHRzdGF0aWMgcmVhZG9ubHkgU0VMRiAgICAgICAgICAgICAgID0gaWQoKTtcblx0c3RhdGljIHJlYWRvbmx5IEVWVF9MT0dPVVRfRkFJTCAgICA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfTE9HT1VUX1NVQ0NFU1MgPSBpZCgpO1xuXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgX2FwcENvbnRleHQ6IE9XZWJBcHApIHtcblx0XHRzdXBlcigpO1xuXHR9XG5cblx0b25Mb2dvdXRGYWlsKFxuXHRcdGhhbmRsZXI6ICh0aGlzOiB0aGlzLCBlcnI6IE9OZXRFcnJvcikgPT4gdm9pZFxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfRkFJTCwgaGFuZGxlcik7XG5cdH1cblxuXHRvbkxvZ291dFN1Y2Nlc3MoXG5cdFx0aGFuZGxlcjogKFxuXHRcdFx0dGhpczogdGhpcyxcblx0XHRcdHJlc3BvbnNlOiBPTmV0UmVzcG9uc2U8T0FwaVJlc3BvbnNlPFJlc3VsdD4+LFxuXHRcdCkgPT4gdm9pZFxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfU1VDQ0VTUywgaGFuZGxlcik7XG5cdH1cblxuXHRsb2dvdXQoKTogUHJvbWlzZTxPTmV0UmVzcG9uc2U8T0FwaVJlc3BvbnNlPFJlc3VsdD4+PiB7XG5cdFx0Y29uc3QgbSA9IHRoaXMsXG5cdFx0XHR1cmwgPSBtLl9hcHBDb250ZXh0LnVybC5nZXQoJ09aX1NFUlZFUl9MT0dPVVRfU0VSVklDRScpLFxuXHRcdFx0bmV0ID0gbS5fYXBwQ29udGV4dC5vei5yZXF1ZXN0PE9BcGlSZXNwb25zZTxhbnk+Pih1cmwsIHtcblx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHR9KTtcblxuXHRcdHJldHVybiBuZXRcblx0XHRcdC5vbkdvb2ROZXdzKGZ1bmN0aW9uIGdvb2ROZXdzSGFuZGxlcihyZXNwb25zZSkge1xuXHRcdFx0XHRtLnRyaWdnZXIoT1dlYkxvZ291dC5FVlRfTE9HT1VUX1NVQ0NFU1MsIFtyZXNwb25zZV0pO1xuXHRcdFx0fSlcblx0XHRcdC5vbkZhaWwoZnVuY3Rpb24gZmFpbEhhbmRsZXIoZXJyKSB7XG5cdFx0XHRcdG0udHJpZ2dlcihPV2ViTG9nb3V0LkVWVF9MT0dPVVRfRkFJTCwgW2Vycl0pO1xuXHRcdFx0fSlcblx0XHRcdC5zZW5kKCk7XG5cdH1cbn1cbiJdfQ==