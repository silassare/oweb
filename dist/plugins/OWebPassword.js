import OWebEvent from '../OWebEvent';
import { id } from '../utils';
export default class OWebPassword extends OWebEvent {
    _appContext;
    static SELF = id();
    static EVT_PASS_EDIT_SUCCESS = id();
    static EVT_PASS_EDIT_FAIL = id();
    constructor(_appContext) {
        super();
        this._appContext = _appContext;
    }
    editPass(data) {
        return this._sendForm({
            action: 'edit',
            cpass: data.cpass,
            vpass: data.vpass,
            pass: data.pass,
        });
    }
    editPassAdmin(data) {
        return this._sendForm({
            action: 'edit',
            uid: data.uid,
            pass: data.pass,
            vpass: data.vpass,
        });
    }
    _sendForm(data) {
        const m = this, url = m._appContext.url.get('OZ_SERVER_PASSWORD_SERVICE'), net = m._appContext.oz.request(url, {
            method: 'POST',
            body: data,
        });
        return net
            .onGoodNews(function goodNewsHandler(response) {
            m.trigger(OWebPassword.EVT_PASS_EDIT_SUCCESS, [response]);
        })
            .onFail(function failHandler(err) {
            m.trigger(OWebPassword.EVT_PASS_EDIT_FAIL, [err]);
        })
            .send();
    }
    onEditFail(handler) {
        return this.on(OWebPassword.EVT_PASS_EDIT_FAIL, handler);
    }
    onEditSuccess(handler) {
        return this.on(OWebPassword.EVT_PASS_EDIT_SUCCESS, handler);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYlBhc3N3b3JkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3BsdWdpbnMvT1dlYlBhc3N3b3JkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sU0FBUyxNQUFNLGNBQWMsQ0FBQztBQUNyQyxPQUFPLEVBQUMsRUFBRSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBSzVCLE1BQU0sQ0FBQyxPQUFPLE9BQU8sWUFBcUIsU0FBUSxTQUFTO0lBSzdCO0lBSjdCLE1BQU0sQ0FBVSxJQUFJLEdBQW9CLEVBQUUsRUFBRSxDQUFDO0lBQzdDLE1BQU0sQ0FBVSxxQkFBcUIsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUM3QyxNQUFNLENBQVUsa0JBQWtCLEdBQU0sRUFBRSxFQUFFLENBQUM7SUFFN0MsWUFBNkIsV0FBb0I7UUFDaEQsS0FBSyxFQUFFLENBQUM7UUFEb0IsZ0JBQVcsR0FBWCxXQUFXLENBQVM7SUFFakQsQ0FBQztJQUVELFFBQVEsQ0FBQyxJQUFvRDtRQUM1RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDckIsTUFBTSxFQUFFLE1BQU07WUFDZCxLQUFLLEVBQUcsSUFBSSxDQUFDLEtBQUs7WUFDbEIsS0FBSyxFQUFHLElBQUksQ0FBQyxLQUFLO1lBQ2xCLElBQUksRUFBSSxJQUFJLENBQUMsSUFBSTtTQUNqQixDQUFDLENBQUM7SUFDSixDQUFDO0lBRUQsYUFBYSxDQUFDLElBQWtEO1FBQy9ELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNyQixNQUFNLEVBQUUsTUFBTTtZQUNkLEdBQUcsRUFBSyxJQUFJLENBQUMsR0FBRztZQUNoQixJQUFJLEVBQUksSUFBSSxDQUFDLElBQUk7WUFDakIsS0FBSyxFQUFHLElBQUksQ0FBQyxLQUFLO1NBQ2xCLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFTyxTQUFTLENBQUMsSUFBZTtRQUNoQyxNQUFNLENBQUMsR0FBSyxJQUFJLEVBQ2IsR0FBRyxHQUFHLENBQUMsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsQ0FBQyxFQUN6RCxHQUFHLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUF1QixHQUFHLEVBQUU7WUFDekQsTUFBTSxFQUFFLE1BQU07WUFDZCxJQUFJLEVBQUksSUFBSTtTQUNaLENBQUMsQ0FBQztRQUVOLE9BQU8sR0FBRzthQUNSLFVBQVUsQ0FBQyxTQUFTLGVBQWUsQ0FBQyxRQUFRO1lBQzVDLENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLHFCQUFxQixFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUMzRCxDQUFDLENBQUM7YUFDRCxNQUFNLENBQUMsU0FBUyxXQUFXLENBQUMsR0FBRztZQUMvQixDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDO2FBQ0QsSUFBSSxFQUFFLENBQUM7SUFDVixDQUFDO0lBRUQsVUFBVSxDQUNULE9BQTZDO1FBRTdDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDMUQsQ0FBQztJQUVELGFBQWEsQ0FDWixPQUdTO1FBRVQsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxxQkFBcUIsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUM3RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9XZWJBcHAgZnJvbSAnLi4vT1dlYkFwcCc7XG5pbXBvcnQgT1dlYkV2ZW50IGZyb20gJy4uL09XZWJFdmVudCc7XG5pbXBvcnQge2lkfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQge09OZXRFcnJvciwgT05ldFJlc3BvbnNlfSBmcm9tICcuLi9PV2ViTmV0JztcbmltcG9ydCB7T0FwaVJlc3BvbnNlfSBmcm9tICcuLi9vem9uZSc7XG5pbXBvcnQge09Gb3JtRGF0YX0gZnJvbSAnLi4vT1dlYkZvcm1WYWxpZGF0b3InO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPV2ViUGFzc3dvcmQ8UmVzdWx0PiBleHRlbmRzIE9XZWJFdmVudCB7XG5cdHN0YXRpYyByZWFkb25seSBTRUxGICAgICAgICAgICAgICAgICAgPSBpZCgpO1xuXHRzdGF0aWMgcmVhZG9ubHkgRVZUX1BBU1NfRURJVF9TVUNDRVNTID0gaWQoKTtcblx0c3RhdGljIHJlYWRvbmx5IEVWVF9QQVNTX0VESVRfRkFJTCAgICA9IGlkKCk7XG5cblx0Y29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBfYXBwQ29udGV4dDogT1dlYkFwcCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRlZGl0UGFzcyhkYXRhOiB7IGNwYXNzOiBzdHJpbmc7IHBhc3M6IHN0cmluZzsgdnBhc3M6IHN0cmluZyB9KTogUHJvbWlzZTxPTmV0UmVzcG9uc2U8T0FwaVJlc3BvbnNlPFJlc3VsdD4+PiB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlbmRGb3JtKHtcblx0XHRcdGFjdGlvbjogJ2VkaXQnLFxuXHRcdFx0Y3Bhc3MgOiBkYXRhLmNwYXNzLFxuXHRcdFx0dnBhc3MgOiBkYXRhLnZwYXNzLFxuXHRcdFx0cGFzcyAgOiBkYXRhLnBhc3MsXG5cdFx0fSk7XG5cdH1cblxuXHRlZGl0UGFzc0FkbWluKGRhdGE6IHsgdWlkOiBzdHJpbmc7IHBhc3M6IHN0cmluZzsgdnBhc3M6IHN0cmluZyB9KTogUHJvbWlzZTxPTmV0UmVzcG9uc2U8T0FwaVJlc3BvbnNlPFJlc3VsdD4+PiB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlbmRGb3JtKHtcblx0XHRcdGFjdGlvbjogJ2VkaXQnLFxuXHRcdFx0dWlkICAgOiBkYXRhLnVpZCxcblx0XHRcdHBhc3MgIDogZGF0YS5wYXNzLFxuXHRcdFx0dnBhc3MgOiBkYXRhLnZwYXNzLFxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBfc2VuZEZvcm0oZGF0YTogT0Zvcm1EYXRhKSB7XG5cdFx0Y29uc3QgbSAgID0gdGhpcyxcblx0XHRcdCAgdXJsID0gbS5fYXBwQ29udGV4dC51cmwuZ2V0KCdPWl9TRVJWRVJfUEFTU1dPUkRfU0VSVklDRScpLFxuXHRcdFx0ICBuZXQgPSBtLl9hcHBDb250ZXh0Lm96LnJlcXVlc3Q8T0FwaVJlc3BvbnNlPFJlc3VsdD4+KHVybCwge1xuXHRcdFx0XHQgIG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHQgIGJvZHkgIDogZGF0YSxcblx0XHRcdCAgfSk7XG5cblx0XHRyZXR1cm4gbmV0XG5cdFx0XHQub25Hb29kTmV3cyhmdW5jdGlvbiBnb29kTmV3c0hhbmRsZXIocmVzcG9uc2UpIHtcblx0XHRcdFx0bS50cmlnZ2VyKE9XZWJQYXNzd29yZC5FVlRfUEFTU19FRElUX1NVQ0NFU1MsIFtyZXNwb25zZV0pO1xuXHRcdFx0fSlcblx0XHRcdC5vbkZhaWwoZnVuY3Rpb24gZmFpbEhhbmRsZXIoZXJyKSB7XG5cdFx0XHRcdG0udHJpZ2dlcihPV2ViUGFzc3dvcmQuRVZUX1BBU1NfRURJVF9GQUlMLCBbZXJyXSk7XG5cdFx0XHR9KVxuXHRcdFx0LnNlbmQoKTtcblx0fVxuXG5cdG9uRWRpdEZhaWwoXG5cdFx0aGFuZGxlcjogKHRoaXM6IHRoaXMsIGVycjogT05ldEVycm9yKSA9PiB2b2lkXG5cdCk6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJQYXNzd29yZC5FVlRfUEFTU19FRElUX0ZBSUwsIGhhbmRsZXIpO1xuXHR9XG5cblx0b25FZGl0U3VjY2Vzcyhcblx0XHRoYW5kbGVyOiAoXG5cdFx0XHR0aGlzOiB0aGlzLFxuXHRcdFx0cmVzcG9uc2U6IE9OZXRSZXNwb25zZTxPQXBpUmVzcG9uc2U8UmVzdWx0Pj4sXG5cdFx0KSA9PiB2b2lkXG5cdCk6IHRoaXMge1xuXHRcdHJldHVybiB0aGlzLm9uKE9XZWJQYXNzd29yZC5FVlRfUEFTU19FRElUX1NVQ0NFU1MsIGhhbmRsZXIpO1xuXHR9XG59XG4iXX0=