import OWebEvent from '../OWebEvent';
import { id } from '../utils';
export default class OWebPassword extends OWebEvent {
    _appContext;
    static SELF = id();
    static EVT_PASS_EDIT_SUCCESS = id();
    static EVT_PASS_EDIT_FAIL = id();
    constructor(_appContext) {
        super();
        this._appContext = _appContext;
    }
    editPass(data) {
        return this._sendForm({
            action: 'edit',
            cpass: data.cpass,
            vpass: data.vpass,
            pass: data.pass,
        });
    }
    editPassAdmin(data) {
        return this._sendForm({
            action: 'edit',
            uid: data.uid,
            pass: data.pass,
            vpass: data.vpass,
        });
    }
    _sendForm(data) {
        const m = this, url = m._appContext.url.get('OZ_SERVER_PASSWORD_SERVICE'), net = m._appContext.oz.request(url, {
            method: 'POST',
            body: data,
        });
        return net
            .onGoodNews(function goodNewsHandler(response) {
            m.trigger(OWebPassword.EVT_PASS_EDIT_SUCCESS, [response]);
        })
            .onFail(function failHandler(err) {
            m.trigger(OWebPassword.EVT_PASS_EDIT_FAIL, [err]);
        })
            .send();
    }
    onEditFail(handler) {
        return this.on(OWebPassword.EVT_PASS_EDIT_FAIL, handler);
    }
    onEditSuccess(handler) {
        return this.on(OWebPassword.EVT_PASS_EDIT_SUCCESS, handler);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT1dlYlBhc3N3b3JkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3BsdWdpbnMvT1dlYlBhc3N3b3JkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sU0FBUyxNQUFNLGNBQWMsQ0FBQztBQUNyQyxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBSzlCLE1BQU0sQ0FBQyxPQUFPLE9BQU8sWUFBcUIsU0FBUSxTQUFTO0lBSzdCO0lBSjdCLE1BQU0sQ0FBVSxJQUFJLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDNUIsTUFBTSxDQUFVLHFCQUFxQixHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQzdDLE1BQU0sQ0FBVSxrQkFBa0IsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUUxQyxZQUE2QixXQUFvQjtRQUNoRCxLQUFLLEVBQUUsQ0FBQztRQURvQixnQkFBVyxHQUFYLFdBQVcsQ0FBUztJQUVqRCxDQUFDO0lBRUQsUUFBUSxDQUFDLElBSVI7UUFDQSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDckIsTUFBTSxFQUFFLE1BQU07WUFDZCxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7WUFDakIsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLO1lBQ2pCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtTQUNmLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFRCxhQUFhLENBQUMsSUFJYjtRQUNBLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNyQixNQUFNLEVBQUUsTUFBTTtZQUNkLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRztZQUNiLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtZQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztTQUNqQixDQUFDLENBQUM7SUFDSixDQUFDO0lBRU8sU0FBUyxDQUFDLElBQWtCO1FBQ25DLE1BQU0sQ0FBQyxHQUFHLElBQUksRUFDYixHQUFHLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLDRCQUE0QixDQUFDLEVBQ3pELEdBQUcsR0FBRyxDQUFDLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQXVCLEdBQUcsRUFBRTtZQUN6RCxNQUFNLEVBQUUsTUFBTTtZQUNkLElBQUksRUFBRSxJQUFJO1NBQ1YsQ0FBQyxDQUFDO1FBRUosT0FBTyxHQUFHO2FBQ1IsVUFBVSxDQUFDLFNBQVMsZUFBZSxDQUFDLFFBQVE7WUFDNUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQzthQUNELE1BQU0sQ0FBQyxTQUFTLFdBQVcsQ0FBQyxHQUFHO1lBQy9CLENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLGtCQUFrQixFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUM7YUFDRCxJQUFJLEVBQUUsQ0FBQztJQUNWLENBQUM7SUFFRCxVQUFVLENBQUMsT0FBNkM7UUFDdkQsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMxRCxDQUFDO0lBRUQsYUFBYSxDQUNaLE9BQTJFO1FBRTNFLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMscUJBQXFCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPV2ViQXBwIGZyb20gJy4uL09XZWJBcHAnO1xuaW1wb3J0IE9XZWJFdmVudCBmcm9tICcuLi9PV2ViRXZlbnQnO1xuaW1wb3J0IHsgaWQgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBPTmV0RXJyb3IsIE9OZXRSZXNwb25zZSB9IGZyb20gJy4uL09XZWJOZXQnO1xuaW1wb3J0IHsgT0FwaVJlc3BvbnNlIH0gZnJvbSAnLi4vb3pvbmUnO1xuaW1wb3J0IHsgT1dlYkZvcm1EYXRhIH0gZnJvbSAnLi4vT1dlYkZvcm0nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPV2ViUGFzc3dvcmQ8UmVzdWx0PiBleHRlbmRzIE9XZWJFdmVudCB7XG5cdHN0YXRpYyByZWFkb25seSBTRUxGID0gaWQoKTtcblx0c3RhdGljIHJlYWRvbmx5IEVWVF9QQVNTX0VESVRfU1VDQ0VTUyA9IGlkKCk7XG5cdHN0YXRpYyByZWFkb25seSBFVlRfUEFTU19FRElUX0ZBSUwgPSBpZCgpO1xuXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgX2FwcENvbnRleHQ6IE9XZWJBcHApIHtcblx0XHRzdXBlcigpO1xuXHR9XG5cblx0ZWRpdFBhc3MoZGF0YToge1xuXHRcdGNwYXNzOiBzdHJpbmc7XG5cdFx0cGFzczogc3RyaW5nO1xuXHRcdHZwYXNzOiBzdHJpbmc7XG5cdH0pOiBQcm9taXNlPE9OZXRSZXNwb25zZTxPQXBpUmVzcG9uc2U8UmVzdWx0Pj4+IHtcblx0XHRyZXR1cm4gdGhpcy5fc2VuZEZvcm0oe1xuXHRcdFx0YWN0aW9uOiAnZWRpdCcsXG5cdFx0XHRjcGFzczogZGF0YS5jcGFzcyxcblx0XHRcdHZwYXNzOiBkYXRhLnZwYXNzLFxuXHRcdFx0cGFzczogZGF0YS5wYXNzLFxuXHRcdH0pO1xuXHR9XG5cblx0ZWRpdFBhc3NBZG1pbihkYXRhOiB7XG5cdFx0dWlkOiBzdHJpbmc7XG5cdFx0cGFzczogc3RyaW5nO1xuXHRcdHZwYXNzOiBzdHJpbmc7XG5cdH0pOiBQcm9taXNlPE9OZXRSZXNwb25zZTxPQXBpUmVzcG9uc2U8UmVzdWx0Pj4+IHtcblx0XHRyZXR1cm4gdGhpcy5fc2VuZEZvcm0oe1xuXHRcdFx0YWN0aW9uOiAnZWRpdCcsXG5cdFx0XHR1aWQ6IGRhdGEudWlkLFxuXHRcdFx0cGFzczogZGF0YS5wYXNzLFxuXHRcdFx0dnBhc3M6IGRhdGEudnBhc3MsXG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIF9zZW5kRm9ybShkYXRhOiBPV2ViRm9ybURhdGEpIHtcblx0XHRjb25zdCBtID0gdGhpcyxcblx0XHRcdHVybCA9IG0uX2FwcENvbnRleHQudXJsLmdldCgnT1pfU0VSVkVSX1BBU1NXT1JEX1NFUlZJQ0UnKSxcblx0XHRcdG5ldCA9IG0uX2FwcENvbnRleHQub3oucmVxdWVzdDxPQXBpUmVzcG9uc2U8UmVzdWx0Pj4odXJsLCB7XG5cdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRib2R5OiBkYXRhLFxuXHRcdFx0fSk7XG5cblx0XHRyZXR1cm4gbmV0XG5cdFx0XHQub25Hb29kTmV3cyhmdW5jdGlvbiBnb29kTmV3c0hhbmRsZXIocmVzcG9uc2UpIHtcblx0XHRcdFx0bS50cmlnZ2VyKE9XZWJQYXNzd29yZC5FVlRfUEFTU19FRElUX1NVQ0NFU1MsIFtyZXNwb25zZV0pO1xuXHRcdFx0fSlcblx0XHRcdC5vbkZhaWwoZnVuY3Rpb24gZmFpbEhhbmRsZXIoZXJyKSB7XG5cdFx0XHRcdG0udHJpZ2dlcihPV2ViUGFzc3dvcmQuRVZUX1BBU1NfRURJVF9GQUlMLCBbZXJyXSk7XG5cdFx0XHR9KVxuXHRcdFx0LnNlbmQoKTtcblx0fVxuXG5cdG9uRWRpdEZhaWwoaGFuZGxlcjogKHRoaXM6IHRoaXMsIGVycjogT05ldEVycm9yKSA9PiB2b2lkKTogdGhpcyB7XG5cdFx0cmV0dXJuIHRoaXMub24oT1dlYlBhc3N3b3JkLkVWVF9QQVNTX0VESVRfRkFJTCwgaGFuZGxlcik7XG5cdH1cblxuXHRvbkVkaXRTdWNjZXNzKFxuXHRcdGhhbmRsZXI6ICh0aGlzOiB0aGlzLCByZXNwb25zZTogT05ldFJlc3BvbnNlPE9BcGlSZXNwb25zZTxSZXN1bHQ+PikgPT4gdm9pZFxuXHQpOiB0aGlzIHtcblx0XHRyZXR1cm4gdGhpcy5vbihPV2ViUGFzc3dvcmQuRVZUX1BBU1NfRURJVF9TVUNDRVNTLCBoYW5kbGVyKTtcblx0fVxufVxuIl19